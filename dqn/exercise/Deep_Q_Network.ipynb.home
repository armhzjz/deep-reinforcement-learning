{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Deep Q-Network (DQN)\n",
    "---\n",
    "In this notebook, you will implement a DQN agent with OpenAI Gym's LunarLander-v2 environment.\n",
    "\n",
    "### 1. Import the Necessary Packages"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: box2d in /home/pythonist/.conda/envs/deepReinforcement/lib/python3.10/site-packages (2.3.10)\n",
      "Requirement already satisfied: box2d-kengz in /home/pythonist/.conda/envs/deepReinforcement/lib/python3.10/site-packages (2.3.3)\n",
      "Requirement already satisfied: gym[box2d] in /home/pythonist/.conda/envs/deepReinforcement/lib/python3.10/site-packages (0.26.1)\n",
      "Requirement already satisfied: numpy>=1.18.0 in /home/pythonist/.conda/envs/deepReinforcement/lib/python3.10/site-packages (from gym[box2d]) (1.26.0)\n",
      "Requirement already satisfied: cloudpickle>=1.2.0 in /home/pythonist/.conda/envs/deepReinforcement/lib/python3.10/site-packages (from gym[box2d]) (2.2.1)\n",
      "Requirement already satisfied: gym-notices>=0.0.4 in /home/pythonist/.conda/envs/deepReinforcement/lib/python3.10/site-packages (from gym[box2d]) (0.0.8)\n",
      "Requirement already satisfied: box2d-py==2.3.5 in /home/pythonist/.conda/envs/deepReinforcement/lib/python3.10/site-packages (from gym[box2d]) (2.3.5)\n",
      "Requirement already satisfied: pygame==2.1.0 in /home/pythonist/.conda/envs/deepReinforcement/lib/python3.10/site-packages (from gym[box2d]) (2.1.0)\n",
      "Requirement already satisfied: swig==4.* in /home/pythonist/.conda/envs/deepReinforcement/lib/python3.10/site-packages (from gym[box2d]) (4.1.1.post1)\n",
      "Requirement already satisfied: pyvirtualdisplay in /home/pythonist/.conda/envs/deepReinforcement/lib/python3.10/site-packages (3.0)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<contextlib.ExitStack at 0x6358cec5f1f0>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import gymnasium as gym\n",
    "\n",
    "!pip3 install box2d box2d-kengz gym[box2d]\n",
    "import random\n",
    "import torch\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import typing\n",
    "from collections import deque\n",
    "from common.schedulers import LinearScheduler, ExponentialAnnealingScheduler, ExponentialDecay\n",
    "from dqn_agent import Agent, DoubleDQN_Agent, AgentPrioritizedReplayBuf\n",
    "import matplotlib.pyplot as plt\n",
    "%matplotlib inline\n",
    "\n",
    "!python -m pip install pyvirtualdisplay\n",
    "from pyvirtualdisplay import Display\n",
    "display = Display(visible=0, size=(1400, 900))\n",
    "display.start()\n",
    "\n",
    "is_ipython = 'inline' in plt.get_backend()\n",
    "if is_ipython:\n",
    "    from IPython import display\n",
    "\n",
    "plt.ion()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2. Instantiate the Environment and Agent\n",
    "\n",
    "Initialize the environment in the code cell below."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "State shape:  (8,)\n",
      "Number of actions:  4\n"
     ]
    }
   ],
   "source": [
    "env = gym.make('LunarLander-v2', render_mode='rgb_array')\n",
    "print('State shape: ', env.observation_space.shape)\n",
    "print('Number of actions: ', env.action_space.n)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Before running the next code cell, familiarize yourself with the code in **Step 2** and **Step 3** of this notebook, along with the code in `dqn_agent.py` and `model.py`.  Once you have an understanding of how the different files work together, \n",
    "- Define a neural network architecture in `model.py` that maps states to action values.  This file is mostly empty - it's up to you to define your own deep Q-network!\n",
    "- Finish the `learn` method in the `Agent` class in `dqn_agent.py`.  The sampled batch of experience tuples is already provided for you; you need only use the local and target Q-networks to compute the loss, before taking a step towards minimizing the loss.\n",
    "\n",
    "Once you have completed the code in `dqn_agent.py` and `model.py`, run the code cell below.  (_If you end up needing to make multiple changes and get unexpected behavior, please restart the kernel and run the cells from the beginning of the notebook!_)\n",
    "\n",
    "You can find the solution files, along with saved model weights for a trained agent, in the `solution/` folder.  (_Note that there are many ways to solve this exercise, and the \"solution\" is just one way of approaching the problem, to yield a trained agent._)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "agent = DoubleDQN_Agent(state_size=8, action_size=4, seed=1536)\n",
    "\n",
    "# watch an untrained agent\n",
    "state = env.reset()[0]\n",
    "img = plt.imshow(env.render())\n",
    "for j in range(200):\n",
    "    action = agent.act(state)\n",
    "    img.set_data(env.render()) \n",
    "    plt.axis('off')\n",
    "    display.display(plt.gcf())\n",
    "    display.clear_output(wait=True)\n",
    "    state, reward, done, _, __ = env.step(action)\n",
    "    if done:\n",
    "        break \n",
    "        \n",
    "env.close()\n",
    "# delete the agent instance, so that any 'local' 'target' network types created will also be removed\n",
    "del agent"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### The epsilon decay scheduler\n",
    "\n",
    "Implement here the epsilon decay funtion and alpha and beta schedulers."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA1wAAAInCAYAAACMd1hyAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguMCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy81sbWrAAAACXBIWXMAAA9hAAAPYQGoP6dpAACV3ElEQVR4nOzdd3hUZf7+8feZ9F5JIyEEkF4UEARkARUUseCquOoK2FYsa8G+rmv9LRbWZVdF3V3Buop9LXwVVIpI712QFkpCSCG9z/n9MZmBIQESmMlkJvdrr1yZnDlnzmdOZrly+zzn8ximaZqIiIiIiIiIy1k8XYCIiIiIiIivUuASERERERFxEwUuERERERERN1HgEhERERERcRMFLhERERERETdR4BIREREREXETBS4RERERERE3UeASERERERFxEwUuERERERERN1HgEhE5xltvvYVhGMf9mj9/vlvO++STT2IYhtO24cOHM3z4cLec71TMnz/frddAnM2ePZsnn3yywecMw+Cuu+5y2bkOHDjAk08+ydq1a132mk1l///e7t27m/W87du3Z+LEic16ThFpPfw9XYCISEs1c+ZMunbtWm979+7d3XK+W265hYsuusgtry3eafbs2bz66qvHDV2udODAAZ566inat2/PmWee6fbzNWTMmDEsWbKE5ORkj5xfRMQdFLhERI6jZ8+e9O/fv9nOl5qaSmpqarOdT1qGsrIyQkNDPV1Gi9CmTRvatGnj6TJERFxKUwpFRE6DfVrXG2+8QefOnQkKCqJ79+58+OGHTvuVlZXxwAMPkJGRQXBwMLGxsfTv358PPvjAsU9DUwobkp+fzx133EHbtm0JDAykQ4cOPPbYY1RWVjZY27vvvku3bt0IDQ2lT58+fP311416b1u3buWiiy4iNDSU+Ph4Jk2aRHFxcYP7fv/995x//vlERkYSGhrKkCFD+OGHHxp8zWuvvZbExESCgoJo164d48ePd9R+6NAh7rjjDrp37054eDgJCQmcd955/PTTT47XME2TM844gwsvvLDe65eUlBAVFcWdd955wvdWUVHBo48+SkZGBoGBgbRt25Y777yTw4cPO/YZO3Ys6enpWK3WescPHDiQvn37OtU0ffp0zjzzTEJCQoiJieGqq65i586dTscNHz6cnj17snDhQgYPHkxoaCg33XRTgzVOnDiRV199FcBpSuux0+0a8/vdvn071113HQkJCQQFBdGtWzfHa4NtqujZZ58NwI033ug418lG1rKzs7nttttITU0lMDCQjIwMnnrqKWpqahz77N69G8MweOGFF/h//+//0a5dO4KDg+nfv3+9z0hDUwrXrFnDJZdc4qg9JSWFMWPGsG/fPsc+jfl9AlRXV/PQQw+RlJREaGgo5557LsuXLz/l9wbw2muv0adPH8LDw4mIiKBr16786U9/OuF1E5FWxhQRESczZ840AXPp0qVmdXW101dNTY3TvoCZlpZmdu/e3fzggw/ML7/80rzoootMwPz4448d+912221maGio+dJLL5nz5s0zv/76a/O5554zX375Zcc+TzzxhHnsP8vDhg0zhw0b5vi5vLzc7N27txkWFmZOnTrVnDNnjvn444+b/v7+5sUXX1yvtvbt25sDBgwwP/roI3P27Nnm8OHDTX9/f3PHjh0nvAbZ2dlmQkKC2bZtW3PmzJnm7Nmzzeuvv95s166dCZjz5s1z7Pvuu++ahmGYY8eONT/77DPzq6++Mi+55BLTz8/P/P777x37rV271gwPDzfbt29vvv766+YPP/xgvvfee+a4cePMoqIi0zRNc+vWrebtt99ufvjhh+b8+fPNr7/+2rz55ptNi8XidM5//OMfpmEY5rZt25zqfvXVV03A3LRp03Hfm9VqNS+88ELT39/ffPzxx805c+aYU6dONcPCwsyzzjrLrKioME3TNP/3v/+ZgDl37lyn47ds2WIC5j//+U/HtltvvdUMCAgw77//fvPbb781//vf/5pdu3Y1ExMTzezsbMd+w4YNM2NjY820tDTz5ZdfNufNm2cuWLCgwTp//fVX86qrrjIBc8mSJY4ve32N/f1u2rTJjIqKMnv16mW+88475pw5c8z777/ftFgs5pNPPmmapmkWFhY6Pvd//vOfHefau3fvca9jVlaWmZaWZqanp5tvvPGG+f3335vPPPOMGRQUZE6cONGx365duxz/Pzn33HPNTz/91Pz444/Ns88+2wwICDAXL17s2Ndew65du0zTNM2SkhIzLi7O7N+/v/nRRx+ZCxYsMGfNmmVOmjTJ3Lx5c5N+n6ZpmhMmTDANwzAffPBBc86cOeZLL71ktm3b1oyMjDQnTJjQ5Pf2wQcfmID5xz/+0ZwzZ475/fffm6+//rp59913H/e6iUjro8AlInIM+x99DX35+fk57QuYISEhTn9U19TUmF27djU7derk2NazZ09z7NixJzxvYwLX66+/bgLmRx995LTf888/bwLmnDlznGpLTEx0hBnTtAUpi8ViTpky5YS1PPzww6ZhGObatWudto8cOdIpcJWWlpqxsbHmpZde6rRfbW2t2adPH3PAgAGObeedd54ZHR1t5uTknPDcR6upqTGrq6vN888/37ziiisc24uKisyIiAjznnvucdq/e/fu5ogRI074mt9++60JmC+88ILT9lmzZpmA+a9//cs0TdOsrq42ExMTzeuuu85pv4ceesgMDAw0c3NzTdM0zSVLlpiA+be//c1pv71795ohISHmQw895Ng2bNgwEzB/+OGHRr3/O++8s95nwq6xv98LL7zQTE1NNQsLC52Ov+uuu8zg4GAzPz/fNE3TXLFihQmYM2fObFRtt912mxkeHm7u2bPHafvUqVOdQq89cKWkpJjl5eWO/YqKiszY2FjzggsucGw7NnCtXLnSBMwvvvjiuHU09vdpD8r33Xef037vv/++CTgFrsa+t7vuusuMjo4+0WUSETE1pVBE5DjeeecdVqxY4fS1bNmyevudf/75JCYmOn728/Pjmmuu4ddff3VMexowYAD/93//xyOPPML8+fMpLy8/pZp+/PFHwsLCuOqqq5y22zusHTtFa8SIEURERDh+TkxMJCEhgT179pzwPPPmzaNHjx706dPHaft1113n9PPixYvJz89nwoQJ1NTUOL6sVisXXXQRK1asoLS0lLKyMhYsWMC4ceNOeo/O66+/Tt++fQkODsbf35+AgAB++OEHtmzZ4tgnIiKCG2+8kbfeeovS0lLHtdm8efNJO/f9+OOPAPW60l199dWEhYU5rqG/vz+///3v+eyzzygsLASgtraWd999l8svv5y4uDgAvv76awzD4Pe//73TNUhKSqJPnz71OjrGxMRw3nnnnbDGxjrZ77eiooIffviBK664gtDQUKf6Lr74YioqKli6dOkpnfvrr79mxIgRpKSkOL3u6NGjAViwYIHT/r/97W8JDg52/BwREcGll17KwoULqa2tbfAcnTp1IiYmhocffpjXX3+dzZs319unsb/PefPmAXD99dc77Tdu3Dj8/Z1vaW/sexswYACHDx/m2muv5X//+x+5ubnHv2Ai0mopcImIHEe3bt3o37+/01e/fv3q7ZeUlHTcbXl5eQD885//5OGHH+aLL75gxIgRxMbGMnbsWLZv396kmvLy8khKSqp3r1dCQgL+/v6O89nZQ8HRgoKCThr47Oc53vuyO3jwIABXXXUVAQEBTl/PP/88pmmSn59PQUEBtbW1J20K8tJLL3H77bczcOBAPv30U5YuXcqKFSu46KKL6tX8xz/+keLiYt5//30AXnnlFVJTU7n88stP+t78/f3rBT/DMEhKSnK6hjfddBMVFRWOe/K+++47srKyuPHGG52ugWmaJCYm1rsGS5curfdHuCs78J3s95uXl0dNTQ0vv/xyvdouvvhigFMOCQcPHuSrr76q97o9evRo8HWP93mqqqqipKSkwXNERUWxYMECzjzzTP70pz/Ro0cPUlJSeOKJJ6iurna8x8b8Pu3fj63D39+/3nVs7Hu74YYbmDFjBnv27OHKK68kISGBgQMHMnfu3JNfQBFpNdSlUETkNGVnZx93m/0PubCwMJ566imeeuopDh486BjtuvTSS9m6dWujzxUXF8eyZcswTdMpdOXk5FBTU0N8fPxpvpsj5znR+7Kzn+/ll1/mnHPOafC1EhMTqa2txc/Pz6nRQUPee+89hg8fzmuvvea0vaFmHZ06dWL06NG8+uqrjB49mi+//JKnnnoKPz+/k763mpoaDh065PRHummaZGdnO5pHgG0JgAEDBjBz5kxuu+02Zs6cSUpKCqNGjXK6BoZh8NNPPxEUFFTvfMdua0xjFFeJiYnBz8+PG2644biNRDIyMk7ptePj4+nduzf/7//9vwafT0lJcfr5eJ+nwMBAwsPDj3ueXr168eGHH2KaJuvXr+ett97i6aefJiQkhEceeaTRv0/7/xezs7Np27atY7+ampp6/6GiKe/txhtv5MYbb6S0tJSFCxfyxBNPcMkll7Bt2zbS09OP+75EpPXQCJeIyGn64YcfHCM9YJt2NmvWLDp27NjgiE5iYiITJ07k2muv5ZdffqGsrKzR5zr//PMpKSnhiy++cNr+zjvvOJ53hREjRrBp0ybWrVvntP2///2v089DhgwhOjqazZs31xsNtH8FBgYSEhLCsGHD+Pjjj084omIYRr2Asn79epYsWdLg/vfccw/r169nwoQJ+Pn5ceutt570vdmv0Xvvvee0/dNPP6W0tLTeNbzxxhtZtmwZ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raBLTBf6J/b3bF0iIiIiIqfAKwPXrFmzuPfee3nsscdYs2YNQ4cOZfTo0WRmZja4/6JFixg/fjw333wzmzZt4uOPP2bFihXccsstzVx58/DaxhnWWls7eKCm5xV8sNW28PH13a7HMAxPViYiIiIickq8MnC99NJL3Hzzzdxyyy1069aNadOmkZaWxmuvvdbg/kuXLqV9+/bcfffdZGRkcO6553LbbbexcuXKZq68eThaw3tb4NqzGEqyITiKeYEWskqziAmK4eIOF3u6MhERERGRU+J1gauqqopVq1YxatQop+2jRo1i8eLFDR4zePBg9u3bx+zZszFNk4MHD/LJJ58wZsyY456nsrKSoqIipy9v4Vj82NvW4rJPJ+x2GR9utz2+qvNVBPkFebAoEREREZFT53WBKzc3l9raWhITE522JyYmkp2d3eAxgwcP5v333+eaa64hMDCQpKQkoqOjefnll497nilTphAVFeX4SktLc+n7cKdEb5xSWFsNm/8HwO6OQ1mevRyLYeHqzld7uDARERERkVPndYHL7th7ekzTPO59Pps3b+buu+/mL3/5C6tWreLbb79l165dTJo06biv/+ijj1JYWOj42rt3r0vrdyevbJqxcz6U50NYAp+V2671uW3PJTk82bN1iYiIiIicBn9PF9BU8fHx+Pn51RvNysnJqTfqZTdlyhSGDBnCgw8+CEDv3r0JCwtj6NChPPvssyQn1/+jPigoiKAg75zK5pVNMzZ8AkBV98v4YseXAFx1xlWerEhERERE5LR53QhXYGAg/fr1Y+7cuU7b586dy+DBgxs8pqysDIvF+a36+fkBtpExX+NomuEt93BVl8PWbwD4MaE9BZUFJIQmMDR1qIcLExERERE5PV4XuAAmT57Mf/7zH2bMmMGWLVu47777yMzMdEwRfPTRRxk/frxj/0svvZTPPvuM1157jZ07d/Lzzz9z9913M2DAAFJSUjz1NtwmMcI2wpVfWkVlTa2Hq2mE7XOgqhii0vgkfy0Avz3jt/hbvG4AVkRERETEiVf+RXvNNdeQl5fH008/TVZWFj179mT27Nmkp6cDkJWV5bQm18SJEykuLuaVV17h/vvvJzo6mvPOO4/nn3/eU2/BraJDAwj0t1BVYyWnqJK02FBPl3Rimz4HYE+XkSzL/h4Dg992+q2HixIREREROX2G6Ytz6tygqKiIqKgoCgsLiYyM9HQ5J/WbF+aRmV/GJ5MG0b99rKfLOb7qcnihI1SXMm3E7by5+xvObXsur13Q8JpqIiIiIiKe1pRs4JVTCuXkkqJs0wqzClt444wdP0J1KbWRqXyVswKwTScUEREREfEFClw+KrkucGW39MC12daRcHnHQeSU5RAZGMmw1GEeLkpERERExDUUuHyUV4xw1VTBL/8HwFdBtjXURmeMJtAv0JNViYiIiIi4jAKXj0quW4sru6jcw5WcwK6FUFlIaXgC3+euBeDSjpd6tiYRERERERdS4PJRSVEhQAsf4dpim074ffu+lNdWkB6ZTu/43h4uSkRERETEdRS4fFSLv4fLWutY7Pgr/xoALu1wKYZheLIqERERERGXUuDyUfbAlVNcSU2t1cPVNGDPYijLJSssluWF2wFNJxQRERER36PA5aPiwoPwtxjUWk1yS6o8XU59ddMJ/69dL0xM+if2JyU8xcNFiYiIiIi4lgKXj/KzGCRG2jsVtrDGGVYrbPkKgG/9bGFwdMZoT1YkIiIiIuIWClw+LKml3se1fyUUZ5EZEsWW0v34GX5ckH6Bp6sSEREREXE5BS4f1mLX4tr6NQDfpvUAYGDyQGKDYz1ZkYiIiIiIWyhw+bAja3G1sMBVt9jxt/626YQXtb/Ik9WIiIiIiLiNApcPa5EjXHk7IHcbOwOD2V6eg7/Fn/PanefpqkRERERE3EKBy4cl1y1+nN2SmmbYR7fadgZgcMpgooKiPFmRiIiIiIjbKHD5sBY5wvXL/2EC3wbaFjjWdEIRERER8WUKXD7MvvjxwaIKrFbTw9UAZfmQuYRfAwLYVVVAoCWQEWkjPF2ViIiIiIjbKHD5sDYRQVgMqK41ySttAYsf//o9mLX8kJAOwKCUQYQHhnu4KBERERER91Hg8mEBfhbaRAQBLWTx47r7t34MCwVQswwRERER8XkKXD4uqa5xhsfv46qpgl+/54C/H1uqD2MxLAxPG+7ZmkRERERE3EyBy8c51uLydODKXAyVRcyLbgPAmW3O1GLHIiIiIuLzFLh8XIvpVGifThhjC1zntzvfk9WIiIiIiDQLBS4fZ+9U6NG1uEwTfpnNYYuFVTXFAIxop+6EIiIiIuL7FLh8XIsY4crZAoczWRAeQS1WOsd0Ji0izXP1iIiIiIg0EwUuH5dc1zQju8iDgWv7dwD8EN8W0HRCEREREWk9FLh8XPJRI1weW/x4+/dUGAZLsIU+LXYsIiIiIq2FApePS4wMxjCgqsbqmcWPK4pg71JWBgdRYdaQEJpA19iuzV+HiIiIiIgHKHD5uEB/C4kRtlGuA4c90Dhj1wKw1vBTTBIAQ9sOxTCM5q9DRERERMQDFLhagZRoW+Da74nAtX0uJrAwJAiA36T+pvlrEBERERHxEAWuVqBtTCjggREu04Rff2B3gD/7rOX4W/w5J/mc5q1BRERERMSDFLhaAY+NcB3aCkX7+CksAoD+if0JDQht3hpERERERDxIgasVaBttaw2/v6CZA9ev3wPwU0wCYLt/S0RERESkNVHgagXsgetAYTMHru1zKTMMVlIJwNBUBS4RERERaV0UuFqBFHvgOtyMix9XlkDmEpaGBFODlbSINNpHtm++84uIiIiItAAKXK2APXDll1ZRVlXTPCfd/RPUVrEwug2gdvAiIiIi0jopcLUCUSEBRAT5A804ylXXDn5xiK1hx7ltz22e84qIiIiItCAKXK3EkWmFzXAfl2nCr3PJ9Pcny1pBgCWAfon93H9eEREREZEWRoGrlWgbU9epsDkCV96vcDiTJWFhAJyZcKbawYuIiIhIq6TA1UrY1+JqlhGuHfMAWBqbDMCg5EHuP6eIiIiISAukwNVKpDTnWlw751MDLLfYGnSck3yO+88pIiIiItICKXC1Eo7Fj909wlVbA7t/YnNQIMXWKiICI+ge19295xQRERERaaEUuFqJZlv8+MAaqCxiSUQ0AAOTBuJn8XPvOUVEREREWigFrlbCPqUw63AFtVbTfSfaOR+ApZFxAAxK0f1bIiIiItJ6KXC1EomRwfhZDGqsJoeKK913op3zKTMM1pq2kTTdvyUiIiIirZkCVyvhZzFIirR1KnTbfVxVpbB3GauCg6jBStvwtqRFpLnnXCIiIiIiXkCBqxVx+1pcmUvAWs3SqDaAbXTLMAz3nEtERERExAsocLUijsYZ7gpcdfdvrQiPAGBA0gD3nEdERERExEsocLUibl/8eOd8iiwGv9SWAtA/qb97ziMiIiIi4iUUuFqRttGhgJsWPy7NhewNrAkKwopJemQ6CaEJrj+PiIiIiIgXUeBqRez3cO1zR+DatQCAlXGpAPRP1OiWiIiIiIgCVyuSWhe49haUYZouXour7v6tlaG2UbR+if1c+/oiIiIiIl5IgasVsTfNKKuqpaCs2nUvbJqwYz4lhsGW6iIAzk4623WvLyIiIiLipRS4WpHgAD8SI4MA2Jtf5roXLtgNhZmsCQmlFiup4akkhSW57vVFRERERLyUAlcrkxZjm/K3t8CFgWv3IgBWtkkH1J1QRERERMROgauVSYutC1z5LmycYQ9cwYGAGmaIiIiIiNgpcLUyaUc1znAJ04Q9P1NmGGyuPgxohEtERERExE6Bq5VJdYxwuShwHd4DhXtZGxJKjWklOSyZtuFtXfPaIiIiIiJeToGrlbHfw+WytbjqphOujm8HqB28iIiIiMjRFLhambRY25TC/QXlWK0uWItr988ArA0NA+CshLNO/zVFRERERHyEAlcrkxQZjJ/FoKrWysHiitN/wd2LqAHW192/dWbCmaf/miIiIiIiPkKBq5Xx97OQEh0MuKBTYcEeKMxke1Aw5dYqwgPC6RjV0QVVioiIiIj4BgWuVujIfVyn2ThjT910wkRbyOrTpg9+Fr/Te00RERERER+iwNUKORY/Pt0Rrrr7t9aERwPQJ6HP6b2eiIiIiIiPUeBqheyNM057La7dPwGwzloCqGGGiIiIiMixFLhaoTRXrMV1eC8c3sNB/wAOVBZgMSz0iu/logpFRERERHyDAlcrlOqKtbjs928ldQGgc0xnwgLCTrs2ERERERFfosDVCtmnFGYVllNdaz21F6mbTrg2ug0AZ7Y50xWliYiIiIj4FAWuVqhNeBDBARasJhw4fIqjXPYFj40qQOtviYiIiIg0RIGrFTIMwzGt8JQ6FRZlQcEuyi1+bC09AKhhhoiIiIhIQxS4Wqm0mNPoVLh3KQCbkrpQY9bSJqQNyWHJrixPRERERMQnKHC1UqfVqTDTFrg2xrYFoHeb3hiG4bLaRERERER8hQJXK9WuLnBlnk7gCvQHoGd8T5fVJSIiIiLiSxS4WqlTDlyVJZC9AYCNlbkAWn9LREREROQ4FLhaqfbxtjWzduWWYppm4w/cvxLMWvKi27G/7CAGBt3jurupShERERER76bA1UrZR7iKK2o4XFbd+APrphNuSu4MQEZUBhGBES6vT0RERETEF/i740WtViubN29m586dFBcXU1tbe9Jjxo8f36RzTJ8+nRdffJGsrCx69OjBtGnTGDp06HH3r6ys5Omnn+a9994jOzub1NRUHnvsMW666aYmnddXBAf4kRQZTHZRBbvzSokJC2zcgXWBa0N4NFTo/i0RERERkRNxaeAqLy/n2Wef5d///jd5eXmNPs4wjCYFrlmzZnHvvfcyffp0hgwZwhtvvMHo0aPZvHkz7dq1a/CYcePGcfDgQd588006depETk4ONTU1jT6nL0qPCyW7qILM/DLOahdz8gNqa2DfCgA2UAno/i0RERERkRNxWeAqLy/nvPPOY/ny5U27J+gUvPTSS9x8883ccsstAEybNo3vvvuO1157jSlTptTb/9tvv2XBggXs3LmT2NhYANq3b3/Cc1RWVlJZWen4uaioyHVvoIVoHxfGsl357M5tZOOMnE1QVYIZFMXGot2AApeIiIiIyIm4LHD9/e9/Z9myZQD07NmTu+66i379+hEbG4vF4rpbxaqqqli1ahWPPPKI0/ZRo0axePHiBo/58ssv6d+/Py+88ALvvvsuYWFhXHbZZTzzzDOEhIQ0eMyUKVN46qmnXFZ3S9QuznYf15680sYdUDedcF9qHwqrdhNgCaBzTGd3lSciIiIi4vVcFrhmzZoFwODBg/nxxx8JDGzkPUFNlJubS21tLYmJiU7bExMTyc7ObvCYnTt3smjRIoKDg/n888/Jzc3ljjvuID8/nxkzZjR4zKOPPsrkyZMdPxcVFZGWlua6N9ICtI+zdSrc09jW8Pb7t+LS4NBuusZ2JcAvwF3liYiIiIh4PZcFrh07dmAYBg899JDbwtbRDMNw+tk0zXrb7KxWK4Zh8P777xMVFQXYpiVeddVVvPrqqw2OcgUFBREUFOT6wluQ9KaMcJnmkcAVaAtZapghIiIiInJiLpvrZw9Zx2ta4Srx8fH4+fnVG83KycmpN+pll5ycTNu2bR1hC6Bbt26Ypsm+ffvcWm9LZg9cuSVVFFecpDV84V4oPgAWfy14LCIiIiLSSC4LXF27dgU47rQ+VwkMDKRfv37MnTvXafvcuXMZPHhwg8cMGTKEAwcOUFJS4ti2bds2LBYLqampbq23JYsIDiCurh38nryTTCusG92qSe7NloJfAI1wiYiIiIicjMsC18SJEzFNk48//thVL3lckydP5j//+Q8zZsxgy5Yt3HfffWRmZjJp0iTAdv/V0W3mr7vuOuLi4rjxxhvZvHkzCxcu5MEHH+Smm246btOM1sI+ypV5svu4MpcAsDO5J5W1lYQFhJEeme7u8kREREREvJrL7uG69dZbmTVrFu+88w4XXHAB1157rateup5rrrmGvLw8nn76abKysujZsyezZ88mPd0WALKyssjMzHTsHx4ezty5c/njH/9I//79iYuLY9y4cTz77LNuq9FbpMeFsTrzMLtPdh9Xpq0D5ZbIOMiDrrFdsRiu6z4pIiIiIs5qa2uprj7JbR/iNoGBgS7ptu6ywLV3715efvll/vCHP/D73/+ezz//nOuuu46uXbsSGhp60uObeu/XHXfcwR133NHgc2+99Va9bV27dq03DVGOapxxorW4KoshZzMAWyy1AHSL7eb22kRERERaI9M0yc7O5vDhw54upVWzWCxkZGScdkNAlwWu9u3bO7oEmqbJp59+yqefftqoYw3DoKamxlWlSBMcaQ1/ghGu/asBE6LasaXYNnLYPa57M1QnIiIi0vrYw1ZCQgKhoaHH7cQt7mO1Wjlw4ABZWVm0a9futH4HLgtcYAtaDT2WluvI4scnGOHatwIAa9t+bM3fAtimFIqIiIiIa9XW1jrCVlxcnKfLadXatGnDgQMHqKmpISDg1NeedVngmjlzpqteSpqRfYQrq7CCiupaggP86u+0byUAmYmdKdu9iiC/IDKiMpqzTBEREZFWwX7PVmNuyRH3sk8lrK2tbRmBa8KECa56KWlGMaEBRAT7U1xRQ2Z+GZ0TI5x3ME3HCNfWMNs6Zl1iuuBvcengqIiIiIgcRdMIPc9VvwO1mWvlDMM40jijoWmFBbuhLBf8Atls2p7vFqeGGSIiIiIijaHAJaTXTSvclVtS/8m66YQk9WZLwTZA92+JiIiISPOaP38+hmE4Oje+9dZbREdHe7SmxnLbvLCDBw8yf/58Nm7cSH5+PgCxsbH07NmT4cOHk5iY6K5TSxN1iLcHrgY6FdZNJzTb9mdL/s+ARrhEREREpHkNHjyYrKwsoqKiPF1Kk7k8cGVlZTF58mQ+++yz47Z69/Pz46qrruJvf/sbycnJri5BmqhDG1vg2nmogcC13zbClZ3YmcJDs/E3/Dkj+ozmLE9EREREWrnAwECSkpI8XcYpcemUwnXr1tG7d28++ugjqqurMU2zwa+amhpmzZpFnz592LBhgytLkFPQIT4cgJ3HjnBVV0DWegA2h9hCWaeYTgT6nd7ibyIiIiLie0zT5IUXXqBDhw6EhITQp08fPvnkE+DIlMBvvvmGPn36EBwczMCBA52ywJ49e7j00kuJiYkhLCyMHj16MHv2bKfjT7QY9GuvvUbHjh0JDAykS5cuvPvuu07PG4bBf/7zH6644gpCQ0M544wz+PLLL11/IY7hssBVWlrKmDFjyMvLwzRNLrjgAmbNmsXu3bupqKigoqKC3bt389FHHzFq1ChM0yQ3N5cxY8ZQVnaCNaDE7TLqRrgOFVdSXFF95Ins9WCthrAEtlTmArp/S0RERKS5maZJWVVNs381dV3dP//5z8ycOZPXXnuNTZs2cd999/H73/+eBQsWOPZ58MEHmTp1KitWrCAhIYHLLrvM0Qr/zjvvpLKykoULF7Jhwwaef/55wsPDG3Xuzz//nHvuuYf777+fjRs3ctttt3HjjTcyb948p/2eeuopxo0bx/r167n44ou5/vrrHbc/uYvLphS+8sorHDhwAIvFwhtvvMHNN99cb5927drRrl07rrrqKmbMmMGtt97K/v37efXVV3nwwQddVYo0UWRwAPHhQeSWVLIrt5TeqdG2J+ru3yL1bLbmbwWgW6zu3xIRERFpTuXVtXT/y3fNft7NT19IaGDj4kJpaSkvvfQSP/74I4MGDQKgQ4cOLFq0iDfeeIM//OEPADzxxBOMHDkSgLfffpvU1FQ+//xzxo0bR2ZmJldeeSW9evVyHN9YU6dOZeLEidxxxx0ATJ48maVLlzJ16lRGjBjh2G/ixIlce+21APz1r3/l5ZdfZvny5Vx00UWNPldTuWyE63//+x+GYTBx4sQGw9axbrrpJm688UZM0+Tzzz93VRlyihq8j8sRuPqzJX8LoIYZIiIiIlLf5s2bqaioYOTIkYSHhzu+3nnnHXbs2OHYzx7GwNZQr0uXLmzZYvs78+677+bZZ59lyJAhPPHEE6xfv77R59+yZQtDhgxx2jZkyBDHa9v17t3b8TgsLIyIiAhycnKa9F6bymUjXNu22VqG/+53v2v0Mddeey0zZsxwHCue0yE+jOW78tl56KjW8HUt4Q8ndiNn50wANcwQERERaWYhAX5sfvpCj5y3saxWKwDffPMNbdu2dXouKCjIKXQdy77A8C233MKFF17IN998w5w5c5gyZQp/+9vf+OMf/9ioGo5dqNg0zXrbAgIC6h1jr91dXBa4Skpsf6jHxsY2+piYmBjANgQpnuUY4bI3zijKgsK9YFjYHmx7rm14W8IDGzePVkRERERcwzCMRk/t85Tu3bsTFBREZmYmw4YNq/e8PXAtXbqUdu3aAVBQUMC2bdvo2vVIj4C0tDQmTZrEpEmTePTRR/n3v//dqMDVrVs3Fi1axPjx4x3bFi9eTLdunp+d5bLfXJs2bThw4ABbtmyhb9++jTrGPsQXHx/vqjLkFDk6FdqnFNa1gyehB9tK9wLQOaazJ0oTERERkRYuIiKCBx54gPvuuw+r1cq5555LUVERixcvJjw8nPT0dACefvpp4uLiSExM5LHHHiM+Pp6xY8cCcO+99zJ69Gg6d+5MQUEBP/74Y6MD04MPPsi4cePo27cv559/Pl999RWfffYZ33//vbvecqO57B6uc845B9M0eemll467/tbRqqur+dvf/oZhGJxzzjmuKkNOkb1T4a7cUqxWE/avsj3Rti/bCmxTPhW4REREROR4nnnmGf7yl78wZcoUunXrxoUXXshXX31FRkaGY5/nnnuOe+65h379+pGVlcWXX35JYKBtyaHa2lruvPNOunXrxkUXXUSXLl2YPn16o849duxY/vGPf/Diiy/So0cP3njjDWbOnMnw4cPd8VabxDCb2u/xOL766isuv/xyDMPgggsuYObMmaSkpDS47/79+7npppuYO3cuhmHw5ZdfMmbMGFeU4TZFRUVERUVRWFhIZGSkp8txuepaK90e/5Yaq8mSR88j+X+/g53z4dJ/cG3Wd2zM28jfhv2NUe1HebpUEREREZ9VUVHBrl27yMjIIDg42NPluMz8+fMZMWIEBQUFREdHe7qcRjnR76Ip2cBlUwovvfRSxo4dyxdffMH3339Phw4dGDlyJAMHDiQxMRHDMMjOzmbZsmXMnTvX0W//iiuuaPFhqzUI8LPQLjaUnbml7MwpIfnAGgBqk/vw65ZXAY1wiYiIiIg0lUvvvvvggw8YP348H3/8MVVVVcyePduxOvTR7INqV199Ne+8844rS5DTkBEfxs7cUg7t2QwVheAfzN6QCCpqKwj2CyYtIs3TJYqIiIiIeBWX3cMFtpaPs2bN4quvvmL06NGEhIRgmqbTV0hICKNHj+brr79m1qxZBAUFubIEOQ32ToW1+1fbNiT1YlvhTgA6RXfCz9L41qAiIiIiInbDhw/HNE2vmU7oSm7pLzlmzBjGjBlDbW0tO3fuJD8/H7C1jO/QoQN+fvrDvSXq0MbWqTAsd4NtQ8pZRxpmxGo6oYiIiIhIU7m1ob+fnx9nnKGFcr1FRrxthCu5dLNtQ0pftuUvAXT/loiIiIjIqXDplELxbh3ahGHByhm1tmmER49wnRGt4CwiIiIi0lQte8lqaVZtwoPoE5RNqFGJNSCMsshk9pfsB+CMGAUuEREREZGmanLguummm1xehGEYvPnmmy5/XWkawzAYEbkPiqEgqjt7i3YBkBCSQExwjIerExERERHxPk0OXG+99RaGYbisANM0FbhakH7+uwHYE9SFX+3TCWM1uiUiIiIiciqaHLjatWvn0sAlLcsZNdsBWGftwH57h0I1zBARERGR07B7924yMjJYs2YNZ555ZqOOeeutt7j33ns5fPiwW2tztyYHrt27d7uhDGkRaqqIL7WFrAUlaZgF3wBqmCEiIiIicqrUNEOOyNmExVpNgRnO4oIwEg7vAGyLHouIiIiISNOpLbwcsX81AJvoQLVZQmFVIQYG7aPae7YuEREREWnxvv32W84991yio6OJi4vjkksuYceOHQ3uO3/+fAzD4JtvvqFPnz4EBwczcOBANmzYUG/f7777jm7duhEeHs5FF11EVlaW47kVK1YwcuRI4uPjiYqKYtiwYaxevdpt7/FUKHDJEQdsH879IV2xBB0EIDUilRD/EE9WJSIiItK6mSZUlTb/l2k2qczS0lImT57MihUr+OGHH7BYLFxxxRVYrdbjHvPggw8ydepUVqxYQUJCApdddhnV1dWO58vKypg6dSrvvvsuCxcuJDMzkwceeMDxfHFxMRMmTOCnn35i6dKlnHHGGVx88cUUFxc3/Tq7iaYUyhEH1gJQEtcLS34OAB2jOnqwIBERERGhugz+mtL85/3TAQgMa/TuV155pdPPb775JgkJCWzevJnw8PAGj3niiScYOXIkAG+//Tapqal8/vnnjBs3DoDq6mpef/11Ona0/U1611138fTTTzuOP++885xe74033iAmJoYFCxZwySWXNLp2d2py4OrQoQNgW7Pp6CFC+/ZTcexriQdUl0POFgD8U/tiKX0bgA7Rp/57FREREZHWY8eOHTz++OMsXbqU3Nxcx8hWZmYm3bt3b/CYQYMGOR7HxsbSpUsXtmzZ4tgWGhrqCFsAycnJ5OTkOH7OycnhL3/5Cz/++CMHDx6ktraWsrIyMjMzXf32Ttkpdyk8tjX86XQvVJv5FiBnM5i1EBpPUlpHLLtsUwrVMENERETEwwJCbaNNnjhvE1x66aWkpaXx73//m5SUFKxWKz179qSqqqpJr3N0NggICKj3nHnUVMeJEydy6NAhpk2bRnp6OkFBQQwaNKjJ53SnJgeuCRMmNGm7eImsdbbvyb05IzECS5DtvxxkRGqES0RERMSjDKNJU/s8IS8vjy1btvDGG28wdOhQABYtWnTS45YuXUq7du0AKCgoYNu2bXTt2rXR5/3pp5+YPn06F198MQB79+4lNzf3FN6B+zQ5cM2cObNJ28VLOAJXH8JDK7D4l2KaBkFmsmfrEhEREZEWLyYmhri4OP71r3+RnJxMZmYmjzzyyEmPe/rpp4mLiyMxMZHHHnuM+Ph4xo4d2+jzdurUiXfffZf+/ftTVFTEgw8+SEhIy2r4pi6FYpO13vY9uQ97incBYFbHsDe/+gQHiYiIiIiAxWLhww8/ZNWqVfTs2ZP77ruPF1988aTHPffcc9xzzz3069ePrKwsvvzySwIDAxt93hkzZlBQUMBZZ53FDTfcwN13301CQsLpvBWXU5dCgdpqOLjJ9jipNzsPrQTAWpnA9oMlnNc10YPFiYiIiIg3uOCCC9i8ebPTtqPvtzIbaDN/7rnnsnHjxgZfb+LEiUycONFp29ixY51e56yzzmLFihVO+1x11VVNLd2tmjVwVVZWsmjRInJzc8nIyGDAgAHNeXo5ntxtUFsJQZEQk8Gv2z8EoLYyke05JR4uTkRERETEe7kscO3Zs4dXX30VgD/96U9ER0c7Pb906VKuuuoqp5Wh+/bty6effuq4UU48xH7/VlIvsFjYWbgTAGtVggKXiIiIiMhpcNk9XJ9//jlTp07lxx9/rBe2iouLGTt2LFlZWZim6fhatWoVY8aMoaamxlVlyKk4qmEGwK+HfwXAWpnIrweLGxz+FRERERE5VcOHD8c0zXq5wRe5LHDNnTsXwzAa7Cryr3/9y7FA2d13383//vc/7rjjDgA2b97M22+/7aoy5FQc1TCjoKKA/Ip8ACzVCZRW1bL/cLkHixMRERER8V4uC1w7d9qmofXr16/ecx999BGGYXDFFVcwbdo0Lr30Ul555RWuvvpqTNPkk08+cVUZ0lRWK2TXBa6k3o7phG3D29IxPg6AX7KLPVWdiIiIiIhXc1ngso9gJSY6d7QrKipi9erVANx4441Oz/3ud78DYN26da4qQ5qqYBdUlYB/MMR3ZsfhHQB0iOpA1+QIALYqcImIiIiInBKXNc0oLrb9UV5bW+u0/eeff6a2thZ/f3+GDx/u9FxaWhoA+fn5ripDmiprre17Yk/w83eMcHWM7kiIvwKXiIiIiMjpcNkIV1RUFAAHDhxw2j5//nwA+vTpQ1hYWIPHBgcHu6oMaSpHw4zeAOwu3A1A+8j2dE2yBa5fsos8UZmIiIiIiNdzWeDq2bMnYOtWaFdbW+u4f2vEiBH1jtm/fz9QfxqiNKOjGmYA7C7aDUD7qPZ0TYoEYOehUiprahs6WkRERERETsBlgeuKK67ANE3effddHn74Yb7++muuu+469uzZA8C4cePqHbNy5UoArcPlKaZ51BpcvamoqeBAiW2Esn1ke5KjgokI9qfGarIjp9SDhYqIiIhISzd8+HDuvfdeT5fR4rgscN12221069YN0zSZOnUql19+uaP74KWXXkr//v3rHfP5559jGEa9e7ukmRTth/J8sPhDQncyizMxMYkIjCA2OBbDMOhWN8r1y0FNKxQRERER93nrrbd8cl0ulwWuoKAgfvjhB37729/i7++PaZoEBARwww038O6779bbf+HChWzevBmAkSNHuqoMaQr76FabbhAQzK7CXQBkRGVgGAYAXeru49qapcYZIiIiIiJN5bLABZCUlMQnn3xCUVER+/fvp6ioiLfffpuIiIh6+6alpTFv3jx+/PFHzj77bFeWIY1lv38rqRfg3DDDzhG41KlQRERERE6ipqaGu+66i+joaOLi4vjzn/+MaZoAVFVV8dBDD9G2bVvCwsIYOHCgo8He/PnzufHGGyksLMQwDAzD4MknnwTgvffeo3///kRERJCUlMR1113nWJLKG7isLfzRgoKCSE5OPuE+GRkZZGRkuOP00lgHN9q+2wNXXcOMjKgjv5duyfZOhQpcIiIiIp5gmiblNeXNft4Q/xDHrKfGevvtt7n55ptZtmwZK1eu5A9/+APp6enceuut3HjjjezevZsPP/yQlJQUPv/8cy666CI2bNjA4MGDmTZtGn/5y1/45ZdfAAgPDwdsQe2ZZ56hS5cu5OTkcN999zFx4kRmz57t8vfsDm4JXOIl7IErsQfQ8AhX50Rb4MouquBwWRXRoYHNWaGIiIhIq1deU87A/w5s9vMuu24ZoQGhTTomLS2Nv//97xiGQZcuXdiwYQN///vfOe+88/jggw/Yt28fKSkpADzwwAN8++23zJw5k7/+9a9ERUVhGAZJSUlOr3nTTTc5Hnfo0IF//vOfDBgwgJKSEkcoa8ncFrhWrVrF999/z8aNGx0LG8fGxtKzZ08uuOAC+vXr565TS2NUFEHBbtvjpF6YpnmkJfxRgSsiOIC20SHsP1zO1uxizukQ1+ylioiIiIh3OOecc5xGxQYNGsTf/vY3Vq5ciWmadO7c2Wn/yspK4uJO/PflmjVrePLJJ1m7di35+flYrVYAMjMz6d69u+vfhIu5PHCtXLmSO++809HyvSF/+tOf6N+/P6+++mqD3QulGeRssX2PSIHQWPLKcympLsFiWGgX6dymv1tyhC1wZRUpcImIiIg0sxD/EJZdt8wj53UlPz8/Vq1ahZ+fn9P2E41SlZaWMmrUKEaNGsV7771HmzZtyMzM5MILL6Sqqsql9bmLSwPXRx99xA033EBNTY3j5rjAwEBiY2MxTZOCggLHhVmxYgVDhgzhvffe4+qrr3ZlGdIYBzfYvifZFqy2dyhMCUsh0M952mCXpAi+35LDLwd1H5eIiIhIczMMo8lT+zxl6dKl9X4+44wzOOuss6itrSUnJ4ehQ4c2eGxgYCC1tbVO27Zu3Upubi7PPfccaWlpACcc2GmJXNalcOvWrUyYMIHq6mr8/Py4/fbbWbFiBaWlpRw4cICsrCxKS0tZuXIlt99+O/7+/lRXVzN+/Hi2bt3qqjKksbKd79+yB672Ue3r7dq1bi2uLWoNLyIiIiInsHfvXiZPnswvv/zCBx98wMsvv8w999xD586duf766xk/fjyfffYZu3btYsWKFTz//POO5hft27enpKSEH374gdzcXMrKymjXrh2BgYG8/PLL7Ny5ky+//JJnnnnGw++yaVwWuJ5//nkqKysJDg5mzpw5vPrqq/Tr189pyNDPz4++ffvy6quvMnfuXIKDg6mqquKFF15wVRnSWI6GGbYRrobu37I7ulNhrdVsjupERERExAuNHz+e8vJyBgwYwJ133skf//hH/vCHPwAwc+ZMxo8fz/3330+XLl247LLLWLZsmWPkavDgwUyaNIlrrrmGNm3a8MILL9CmTRveeustPv74Y7p3785zzz3H1KlTPfkWm8ww7XP/TlO7du3Yv38/Dz/8MH/9618bdcyf/vQnnnvuOVJTU8nMzHRFGW5TVFREVFQUhYWFREZGerqc02O1wpRUqC6FO5dDmy7c8f0d/LT/Jx4/53HGdRnntHut1aTnE99RXl3L95OH0Smh5XeDEREREfFGFRUV7Nq1i4yMDIKDgz1dTqt2ot9FU7KBy0a4Dh06BMDFF1/c6GPGjBnjdKw0k4JdtrDlFwSxHYGG1+Cy87MYdK0b5dp0oLDZyhQRERER8XYuC1xt2rQBaFISDwoKAiA+Pt5VZUhj2KcTJnQDP3+qaqvYX7IfaHhKIUCPFFty33SgqDkqFBERERHxCS4LXEOGDAFs3Qcba/ny5QCce+65ripDGsPeMKOuQ2FmUSZW00pYQBjxIQ2H354pUYBGuEREREREmsJlgWvy5Mn4+fnx17/+tVFTBHNycpgyZQoBAQHcd999ripDGuPgJtv3xF4A7CnaA9hGt45eqO5oPRyBqwgX3fYnIiIiIuLzXBa4zj77bN544w1ycnIYOHAgX3zxhWMV6KNZrVb+97//MWjQIA4dOsRrr73GgAEDXFWGNIZ9Da66lvCZxbaGJccueHy0zknh+FsMDpdVc6Cwwu0lioiIiLRm+g/cnueq34HLFj6+6aabAOjevTvr1q3jyiuvJCYmhrPOOouEhAQMw+DgwYOsXbuW/Px8APr06cOiRYtYtGhRg69pGAZvvvmmq0oUgIpCOFzXEdI+pbAucKVHph/3sCB/PzolhLM1u5iN+wtpG+3alcdFREREBAICAgAoKysjJER/b3lSVVUVgNMyV6fCZYHrrbfeckxHMwwD0zTJz8/nxx9/dNrPnhQNw2DdunWsW7euwdczTVOByx3s0wkjUyEkBrDdwwXQLuL4I1wAPdtGsTW7mE0HiriwR5JbyxQRERFpjfz8/IiOjiYnJweA0NDQ497yIe5jtVo5dOgQoaGh+PufXmRyWeBq166dPgzewHH/Vg/HJvsIV1pE2gkP7ZESySerYLMaZ4iIiIi4TVKS7T9s20OXeIbFYnFJxnFZ4Nq9e7erXkrcKbvu/q266YQVNRVkl2YDJ76HC5wbZ4iIiIiIexiGQXJyMgkJCVRXV3u6nFYrMDAQi+X0W164LHCJl7CvwZVoC1z29bfCA8KJCYo54aHd6hY/ziqsIK+kkrjwIPfVKSIiItLK+fn5nfb9Q+J5LutSKF7AaoWcLbbHiUfW4ALbdMKTDZdGBAeQER8GaJRLRERERKQxTilwTZ48mcmTJx93XmltbS2ZmZlkZmae8HV27txJ37596dev36mUIU11eDdUl4FfEMR1BBrXEv5o3VMiAQUuEREREZHGOKUphdOmTcMwDG655RYSEhLqPb9161Z69eqFxWKhpqbmuK9TXl7O2rVr1WyjudhHt9p0AYtteHpv8V7g5B0K7XqkRPLN+iw2qnGGiIiIiMhJuXVKoRZsa2FyNtu+J3R3bDp6SmFj9G4bDcCGfQpcIiIiIiIn47X3cE2fPp2MjAyCg4Pp168fP/30U6OO+/nnn/H39+fMM890b4EtkX2EK6GbY1NTpxT2SrV1KszML6OgtMq19YmIiIiI+BivDFyzZs3i3nvv5bHHHmPNmjUMHTqU0aNHn/SescLCQsaPH8/555/fTJW2MI7AZRvhqqqtIqs0C4D0yPRGvURUyJHGGev2HXZ5iSIiIiIivsQrA9dLL73EzTffzC233EK3bt2YNm0aaWlpvPbaayc87rbbbuO6665j0KBBzVRpC1JTBbnbbI/rRrj2l+zHaloJ8Q8hLjiu0S/Vu26Ua72mFYqIiIiInJDXBa6qqipWrVrFqFGjnLaPGjWKxYsXH/e4mTNnsmPHDp544olGnaeyspKioiKnL6+WvwOsNRAYAVGpgHPDjKY0LumTGg3Aeo1wiYiIiIickNcFrtzcXGpra0lMTHTanpiYSHZ2doPHbN++nUceeYT3338ff//GNWacMmUKUVFRjq+0tMY1lWixHA0zukFduLI3zGjs/Vt2fdJsI1xr9xaqMYqIiIiIyAl4XeCyO3ZExjTNBkdpamtrue6663jqqafo3Llzo1//0UcfpbCw0PG1d+/e067Zo07QMKOxHQrtuidH4WcxyC2pJKuwwmUlioiIiIj4mlNah8uT4uPj8fPzqzealZOTU2/UC6C4uJiVK1eyZs0a7rrrLgCsViumaeLv78+cOXM477zz6h0XFBREUFCQe96EJxzTMAOO6lDYyDW47EIC/eiSGMHmrCLW7ztMSnSIy8oUEREREfElpxW4pk+f3uDCxzk5OY7HTz/99HGPP3q/xgoMDKRfv37MnTuXK664wrF97ty5XH755fX2j4yMZMOGDfXq/vHHH/nkk0/IyMhocg1e6egphXX2FtXdw9XEKYVgm1a4OauItXsLuahnsktKFBERERHxNacVuE7UFdA+ve+pp546nVM0aPLkydxwww3079+fQYMG8a9//YvMzEwmTZoE2KYD7t+/n3feeQeLxULPnj2djk9ISCA4OLjedp9VVQb5u2yP60a4qq3VHCg5ADR9SiFA79RoPli+V40zRERERERO4JQDlyebJVxzzTXk5eXx9NNPk5WVRc+ePZk9ezbp6ba1pLKysk66JlerkvsLYEJoPIS3ASC7JJsas4YgvyASQuuPUp6MvTX8hn2FWK0mFkvjuxyKiIiIiLQWpxS45s2b5+o6muyOO+7gjjvuaPC5t95664THPvnkkzz55JOuL6qlaqBhxt4S23TCtuFtsRhN753SOTGC4AALxZU17MwtpVNCuEtKFRERERHxJacUuIYNG+bqOsSdHPdvHWmYsb9kPwCpEamn9JIBfhZ6pESxak8B6/cdVuASEREREWmA17aFlyZoYIRrX/E+wDbCdarsCyCvyTx8yq8hIiIiIuLLFLhagwZawttHuE4ncPVNjwZgdWbBKb+GiIiIiIgvU+DydeWHocgWrkjo6ti8v/j0phQC9EuPAWBLVhGllTWn/DoiIiIiIr5KgcvXHdpq+x6ZCsFRjs37SmxTClPDTz1wJUeFkBIVjNWEdWoPLyIiIiJSjwKXr2tgwePS6lIOVx4GTm9KIUDfulGu1Xs0rVBERERE5FgKXL4up26Eq00XxyZ7w4zooGjCA0+vu6B9WuEqBS4RERERkXoUuHxd7i+2722O3L9ln054uqNbAH3b1Y1wZR7GavXcYtgiIiIiIi2RApevO7TN9r2Naxtm2HVPiSQ4wEJheTU7c0tP+/VERERERHyJApcvqyiE4gO2x206Oza7oiW8XYCfhd5163HpPi4REREREWcKXL4sd7vte0Rygx0KXRG4QPdxiYiIiIgcjwKXL7O3hI/v7LTZlVMKAfrV3ce1Sgsgi4iIiIg4UeDyZYfsDTOOdCg0TdMxpfB01uA62lntogH4NaeEwrJql7ymiIiIiIgvUODyZbn2hhlHAldeRR4VtRUYGCSHJbvkNHHhQWTEhwGwWqNcIiIiIiIOCly+zDGlsP4aXElhSQT4BbjsVP3r7uNativfZa8pIiIiIuLtFLh8VXU5FOyxPXbTGlxHG9ghDoDlu/Jc+roiIiIiIt5MgctX5W4HTAiJgbB4x2Z7wwyXB66MWADW7yukrKrGpa8tIiIiIuKtFLh8Ve5RCx4bhmOzo2GGizoU2qXGhJASFUyN1WT1nsMufW0REREREW+lwOWr7B0Kj2kJ764phYZhaFqhiIiIiMgxFLh8lb1hxlEdCuHIlMK0iDSXn3JA3bTCpWqcISIiIiICKHD5rgZawtdYazhYdhCAlPAUl5/Sfh/X2r2Hqaiudfnri4iIiIh4GwUuX1RbDXm/2h4f1RI+pyyHWrOWAEsA8SHxxzn41GXEh9EmIoiqGivr9h52+euLiIiIiHgbBS5flL8LrDUQGA5RR5pjHCg5ANjW4LIYrv/VG4bhmFao9bhERERERBS4fFOuvWHGGU4dCrNKswBICXP9dEK7cxyBS40zREREREQUuHyRo2FGV6fN9sCVHJ7stlPbOxWu2lNAVY3VbecREREREfEGCly+6FBdw4xjWsLbpxQmh7kvcHVqE05sWCAV1VbW7TvstvOIiIiIiHgDBS5fdJyW8I4RLjcGLovFYFBH2yjXz7/muu08IiIiIiLeQIHL11itRzoUHjOl0D7C5Y6W8Ec7t5OtA6ICl4iIiIi0dgpcvqZoH1SXgSUAotMdm03TJLs0G3Bv0ww4ErjWZB6mpLLGrecSEREREWnJFLh8Te522/fYDuDn79hcUFlARW0FAIlhiW4tIS02lHaxodRYTZarW6GIiIiItGIKXL7GseDxGU6bs0ps92+1CWlDoF+g28sY0sl2H9ei7QpcIiIiItJ6KXD5GvsIV1wnp80HSus6FLqxJfzRhug+LhERERERBS6fk1cXuI4Z4XI0zHDz/Vt2gzvaAtcvB4vJKa5olnOKiIiIiLQ0Cly+JrduSmGcc+CyN8xorhGu2LBAeqREArD4V00rFBEREZHWSYHLl1SV2roUwnFHuNy5Btex1B5eRERERFo7BS5fkrfD9j0kFkJjnZ6yL3rcXFMK4ch9XIt+zcU0zWY7r4iIiIhIS6HA5UuOc/8WNH/TDICz28cS6G8hq7CC7TklzXZeEREREZGWQoHLlxzn/q2y6jIKKwuB5h3hCgn0Y1AHW3v4eVtzmu28IiIiIiIthQKXL3GMcDm3hLdPJ4wIiCA8MLxZSxrepQ0A83851KznFRERERFpCRS4fIljDa7jNMxoxumEdiO6JACwYnc+xRXVzX5+ERERERFPUuDyFaYJeXVTCo+5h8sTDTPs2seHkREfRo3V5Ge1hxcRERGRVkaBy1cUZ0NVCRh+EJPh9JQnR7gAhnW2TyvUfVwiIiIi0roocPkK+/1bMengH+j0lH2EqznX4DraiK62aYXzfzmk9vAiIiIi0qoocPmK49y/BUcFLg+NcA3MiCU4wEJ2UQVbs4s9UoOIiIiIiCcocPmK49y/BZBdmg1AUmhSc1bkEBzgx+COtkWQ52laoYiIiIi0IgpcvsIxwuXcEr7WWsuhMltL9qQwzwQugBF17eG1HpeIiIiItCYKXL7CsQaX8whXXkUeNWYNFsNCfEi8Bwqzsd/HtWpPAXkllR6rQ0RERESkOSlw+YKaSjicaXt8zD1cB0sPAtAmpA3+Fv/mrswhNSaUHimRWE34QaNcIiIiItJKKHD5gvydYFohMALCE5yeOlhmC1yJYYmeqMzJyO62GuZsOujhSkREREREmocCly+w378V3wkMw+kpTzfMONqo7rYaFv16iPKqWg9XIyIiIiLifgpcviDv+C3hW9IIV7fkCFJjQqiotrJw+yFPlyMiIiIi4nYKXL4gb4ftewtsCX80wzAco1yaVigiIiIirYECly/I32n7Htuh3lMtaYQLjtzH9ePWg9TUWj1cjYiIiIiIeylw+QL7CFdDgauuS2FiaMsIXGe3jyE6NICCsmpW7inwdDkiIiIiIm6lwOXtKoqgtK7NelxHp6dqrbXklNme8+Six0fz97Nwfldb+PtuU7aHqxERERERcS8FLm9nn04YGg/BUc5PVeS3iEWPj3VRT1v4+78N2VitpoerERERERFxHwUub2cPXMeMbsGRhhmeXvT4WL/pHE9EkD/ZRRWsytS0QhERERHxXQpc3i7/BPdvtbCGGXZB/n6M7GGr6Zv1WR6uRkRERETEfRS4vF2evUNh/REue+BqCS3hj3VJ72QAvtmQRa2mFYqIiIiIj1Lg8naOKYX1R7jsUwpb2ggXwLmd2hAZ7M+h4kpW7M73dDkiIiIiIm6hwOXtHFMKGxjhamEt4Y8W6G/hwh62kbev1x/wcDUiIiIiIu6hwOXNKoqg9JDtcQP3cGWX2Ua4WkpL+GONqZtW+O3GbC2CLCIiIiI+SYHLm9lHt8LaQHBkvadb8ggXwJBO8USHBpBbUsWyXZpWKCIiIiK+R4HLm+Ufv2FGS1z0+FgBfhZG163J9cWa/R6uRkRERETE9RS4vFne8dfgaqmLHh/rirNSAZi9IYvyqloPVyMiIiIi4loKXN6sEWtwtbRFj4/VPz2G1JgQSqtqmbM529PliIiIiIi4lAKXN8s7fuBqyS3hj2axGPz2rLYAfLZa0wpFRERExLcocHmz/ONPKWzJix4f64q+tmmFP20/RE5xhYerERERERFxHQUub1VRCGW5tsdePMIFkBEfRt920VhN+HKt1uQSEREREd+hwOWt7NMJwxMhKKLe0/YRrpbaEv5Y9lGuTzWtUERERER8iAKXt3K0hK8/ugVwqMy2IHJCaEJzVXRaLu2dTICfwZasIjYfKPJ0OSIiIiIiLqHA5a1OsAYXwKFyW+BqE9KmuSo6LdGhgYzsbhuNm7Ui08PViIiIiIi4hgKXt7JPKYyrP8JlmqZj0WNvGeEC+N3Z7QD4fM1+Kqq1JpeIiIiIeD8FLm/lWIOr/ghXSXUJ5TXlALQJ9Y4RLoBzO8WTGhNCUUUNszdkebocEREREZHT5rWBa/r06WRkZBAcHEy/fv346aefjrvvZ599xsiRI2nTpg2RkZEMGjSI7777rhmrdbEDa2DfCtvjBlrC2+/figiMIMQ/pDkrOy0Wi8Hvzk4D4IPlmlYoIiIiIt7PKwPXrFmzuPfee3nsscdYs2YNQ4cOZfTo0WRmNvxH+sKFCxk5ciSzZ89m1apVjBgxgksvvZQ1a9Y0c+Uusm+l7bvFH2Iy6j2dU143nTDEe6YT2l3dPw0/i8GK3QX8mlPs6XJERERERE6LVwaul156iZtvvplbbrmFbt26MW3aNNLS0njttdca3H/atGk89NBDnH322Zxxxhn89a9/5YwzzuCrr75q5spdpE1X6DsBrngDgsLrPW0f4fKm6YR2iZHBnNfVFhQ/WL7Xw9WIiIiIiJwerwtcVVVVrFq1ilGjRjltHzVqFIsXL27Ua1itVoqLi4mNjT3uPpWVlRQVFTl9tRgZQ+Gyf0Kvqxp82r4Glzc1zDjatQNs0wo/Xb1PzTNERERExKt5XeDKzc2ltraWxETnBX0TExPJzs5u1Gv87W9/o7S0lHHjxh13nylTphAVFeX4SktLO626m5O3rcF1rGGdE2gbHcLhsmq+WnfA0+WIiIiIiJwyrwtcdoZhOP1smma9bQ354IMPePLJJ5k1axYJCccPJI8++iiFhYWOr717vWd6m7etwXUsP4vBDYPSAXhr8W5M0/RwRSIiIiIip8brAld8fDx+fn71RrNycnLqjXoda9asWdx888189NFHXHDBBSfcNygoiMjISKcvb+GNa3Ad63dnpxEcYGHTgSJW7inwdDkiIiIiIqfE6wJXYGAg/fr1Y+7cuU7b586dy+DBg4973AcffMDEiRP573//y5gxY9xdpkfZA5c3Ns2wiw4N5Iqz2gLw1s+7PVuMiIiIiMgp8rrABTB58mT+85//MGPGDLZs2cJ9991HZmYmkyZNAmzTAcePH+/Y/4MPPmD8+PH87W9/45xzziE7O5vs7GwKCws99RbcxmpaHVMKE0NPPOLX0k0Y3B6Abzdlc+BwuWeLERERERE5BV4ZuK655hqmTZvG008/zZlnnsnChQuZPXs26em2+36ysrKc1uR64403qKmp4c477yQ5Odnxdc8993jqLbjN4crD1FhrAIgLifNwNaena1IkgzrEUWs1eW/pHk+XIyIiIiLSZIapjgSNUlRURFRUFIWFhS36fq5f8n/hqq+uIjY4lgXXLPB0Oaftu03Z3PbuKqJDA/j54fMIC/L3dEkiIiIi0so1JRt45QiXHJ+3r8F1rAu6JdI+LpTDZdXMWuE9nSJFRERERECBy+fY1+Dy1pbwx/KzGNz6mw4AvLloF9W1Vg9XJCIiIiLSeApcPian3Ptbwh/ryr6pxIcHsf9wuRZCFhERERGvosDlY+wjXL4UuIID/Ljp3PYAvL5gB1arbjsUEREREe+gwOVjHFMKvXgNroZcPzCd8CB/th0sYd4vOZ4uR0RERESkURS4fIyjaUaI74xwAUSFBHD9wHYAvDrvV9RcU0RERES8gQKXj7EveuxrI1wANw/NIDjAwurMwyzcnuvpckRERERETkqBy4fUWGvIK88DfOseLruEiGB+P9C2uPVLc7dplEtEREREWjwFLh+SV56HiYmf4UdscKyny3GL24Z1JDjAwrq9h5n/yyFPlyMiIiIickIKXD4kp8zWTCI+JB6L4Zu/2jYRQYwf1B6Av3+vUS4RERERadl886/yVsoX1+BqyB9+04GQAD/W7yvkhy3qWCgiIiIiLZcClw9xtIQP8b2GGUeLDw9iwuD2ALzw3VZqtS6XiIiIiLRQClw+JLfc1rnPFzsUHuv2YR2JCglg28ESPlm119PliIiIiIg0SIHLh9gDV1xInIcrcb+o0AD+eF4nAP42ZxtlVTUerkhEREREpD4FLh/iGOHy8SmFdjcMSictNoSc4kre/GmXp8sREREREalHgcuH2ANXfEi8hytpHkH+fjx4YVcAXl+wg0PFlR6uSERERETEmQKXD2ltgQvgkl7J9EmNorSqlr9/v83T5YiIiIiIOFHg8hFW00peRR7QugKXxWLw2JjuAHywPJMN+wo9XJGIiIiIyBEKXD6isLKQGqutcURcsO83zTjagIxYxp6ZgmnCn/+3EavaxIuIiIhIC6HA5SPs0wmjg6IJ8AvwcDXN708XdyM8yJ91ew/z0Uq1iRcRERGRlkGBy0e0xvu3jpYQGcx9IzsD8Py3WykorfJwRSIiIiIiClw+ozWtwXU8Ewal0yUxgoKyal74bqunyxERERERUeDyFXnlra9hxrH8/Sw8fXkPAD5YvpclO/I8XJGIiIiItHYKXD7iUPkhoPUsenw8AzvEce2AdgA8/Ol6yqpqPFyRiIiIiLRmClw+orXfw3W0P13clZSoYDLzy3jxu188XY6IiIiItGIKXD7CPqWwNd/DZRcRHMCUK3sD8Nbi3azcne/hikRERESktVLg8hEa4XI2rHMbru6XimnCQ59oaqGIiIiIeIYCl4/QPVz1/fmS7iRFBrMzt5Rnvt7s6XJEREREpBVS4PIBVbVVFFUVARrhOlpUSAAvjeuDYdi6Fv7fhixPlyQiIiIirYwClw+w37/lb/EnMjDSw9W0LIM7xTNpWEcAHvlsAwcOl3u4IhERERFpTRS4fMDR928ZhuHhalqeySM70yc1isLyau6dtZZaq+npkkRERESklVDg8gGOwBWs6YQNCfCz8I/fnUVYoB/Ld+UzdY5axYuIiIhI81Dg8gH2hhnxoQpcx9M+Poznr7K1in9t/g7dzyUiIiIizUKBywfY7+FSw4wTu6R3CrcOzQDggY/X8WtOsYcrEhERERFfp8DlA7QGV+M9fFFXzukQS2lVLX94dxVFFdWeLklEREREfJgClw/QPVyN5+9n4ZXr+pIcFczOQ6Xc+f5qqmutni5LRERERHyUApcPcAQu3cPVKPHhQfzrhv6EBPjx0/Zc/vK/jZimOheKiIiIiOspcPkATSlsul6pUfzz2rMciyK/vmCnp0sSERERER+kwOXlTNNU4DpFI7sn8pdLugPw/Ldb+d/a/R6uSERERER8jQKXlyuuLqbKWgVAXHCch6vxPjcOyeDGIe0BuP+jdXy/+aBnCxIRERERn6LA5eXso1sRAREE+wd7uBrv9PiY7ow9M4Uaq8kd/13N4l9zPV2SiIiIiPgIBS4vZ1+DKy5Eo1unymIxmHp1H0Z1T6Sqxsot76xk1Z4CT5clIiIiIj5AgcvLKXC5hr+fhZevO4uhZ8RTVlXL+DeXsWxnnqfLEhEREREvp8Dl5fIqbKEgNjjWw5V4vyB/P964oR+DO8ZRWlXLhJnLWbRd0wtFRERE5NQpcHm5/Ip8QA0zXCU00J8ZE89meJc2VFRbuentFfywRY00REREROTUKHB5OfuUwtgQjXC5SnCAbaTrwh62e7pue3cVn6za5+myRERERMQLKXB5OY1wuUeQvx+vXtfX0b3wgY/XMe37bZim6enSRERERMSLKHB5OQUu9/H3s/DSuDO5fXhHAKZ9v50HPl5PVY3Vw5WJiIiIiLdQ4PJymlLoXhaLwcMXdeWvV/TCz2Lw6ep93PDmMg4VV3q6NBERERHxAgpcXk4jXM3juoHt+M+E/oQH+bNsVz6XvryI1Zlaq0tERERETkyBy4uV15RTVlMGqC18cxjRJYEv7hxCxzZhZBdVcM0bS3h36R7d1yUiIiIix6XA5cXso1uBlkDCAsI8XE3r0CkhnP/ddS6jeyZRXWvy+BcbufO/qzlcVuXp0kRERESkBVLg8mL55XXTCUPiMAzDw9W0HuFB/ky/vi+Pju6Kv8Vg9oZsLpr2E4t3aJFkEREREXGmwOXF8irqGmZoOmGzMwyD24Z15LM7BpMRb5tieP1/lvHs15spq6rxdHkiIiIi0kIocHkx+5RCBS7P6Z0azTd3n8u1A9IwTfjPol1cOG0hP20/5OnSRERERKQFUODyYo4OhSHqUOhJoYH+TPltb2ZM7E9KVDB788u54c3l3P/ROvJLdW+XiIiISGumwOXFHGtwaYSrRTivayJzJg9j4uD2GAZ8unofw1+cx4xFu6iu1WLJIiIiIq2RApcXs9/DpTW4Wo7wIH+evKwHn0waTNekCIoqanj6681cNG0h837J8XR5IiIiItLMFLi8mOMerhCNcLU0/dJj+Obuofy/K3oSGxbIjkOl3DhzBdf+aykrd+d7ujwRERERaSYKXF5MUwpbNj+LwfUD05n3wHBuHZpBgJ/Bkp15XPX6EsbPWM7avYc9XaKIiIiIuJkClxdzNM3QlMIWLSokgMfGdGf+gyO4dkAa/haDhdsOMfbVnxk/Yzk//5qLaZqeLlNERERE3ECBy0vVWms5XHkYUJdCb9E2OoQpv+3Nj/cP56p+qVgMWLjtENf/Zxlj/rmIL9bsV3MNERERER9jmPpP641SVFREVFQUhYWFREZGeroc8srzGP7RcAwMVt+wGn+Lv6dLkibKzCtjxs+7mLViL+XVtQAkRgYxrn8a15ydRmpMqIcrFBEREZGGNCUbaITLS9mnE0YHRStseal2caE8eVkPljx6Hg9e2IX48CAOFlXy8o+/MvSFeUycuZxvN2Zr1EtERETEi+kvdS9lbwmvhhneLzo0kDtHdOLWoR2Yu/kg/12+h59/zWP+L4eY/8shokMDuLhXMpf1SWFA+1gsFsPTJYuIiIhIIylwean8crWE9zWB/hbG9E5mTO9kdueW8uGKvXyyah+5JZX8d1km/12WSVJkMJf0Tuainkmc1S4GP4UvERERkRZNgctLqUOhb2sfH8Yjo7vywKjOLN2Zz5fr9vN/G7PJLqrgP4t28Z9Fu4gNC2R4lzZc0C2RoWfEExEc4OmyRUREROQYClxeSlMKWwd/PwvnnhHPuWfE88zYniz45RDfbMhi/i+HyC+t4rPV+/ls9X4C/Az6pccwuGM8QzrF0Ts1mgA/3aIpIiIi4mkKXF7KMcKllvCtRpC/H6N6JDGqRxI1tVZW7inghy0H+WFLDjtzS1m6M5+lO/N5aS6EBvoxICOWQR3i6JceQ8+2UQQH+Hn6LYiIiIi0OgpcXspxD5dGuFolfz8L53SI45wOcTw2pjs7D5WweEcei3fksmRHHgVl1Y6mGwD+FoPuKZGclRbNWe1iODMtmnaxoWrAISIiIuJmClxeSlMK5Wgd2oTToU04vz8nHavVZGt2MYt35LJsVz5rMg+TW1LJ+n2FrN9XyNtL9gAQHuRP16QIuiVH0jW57ntSBKGB+mdBRERExFX0l5WX0pRCOR5L3WhW95RIbhnaAdM02X+4nDWZh21fewvYtL+IksoaVu4pYOWeAsexhgGpMSFkxIfTIT6Mjm3C6sJcGEmRwRiGRsREREREmkKBywvtLd7L/pL9gEa45OQMwyA1JpTUmFAu7ZMCQHWtlZ2HStmSVcSWrCI2ZxWxNbuYQ8WV7M0vZ29+OQu3HXJ6ndBAP9JiQmkbE0Lb6BDaxoSQFBms1vQiIiLSrIZ0iic2LNDTZTSaApcXWrhvoeOx2sLLqQjws9AlKYIuSRGMPautY3tuSSU7ckrYmVvKzkMl7MotZeehUvbkl1FWVcsvB4v55WCxBysXERGR1u6zOwYrcDWH6dOn8+KLL5KVlUWPHj2YNm0aQ4cOPe7+CxYsYPLkyWzatImUlBQeeughJk2a1IwVu05SaBJnJZzF4JTBhAaEeroc8SHx4UHEhwcxsINzkK+utZKZX8a+gnL2F5Sz/3AZ+wvKySmuxDQ9VKyIiIi0ShFB3hVhvKvaOrNmzeLee+9l+vTpDBkyhDfeeIPRo0ezefNm2rVrV2//Xbt2cfHFF3Prrbfy3nvv8fPPP3PHHXfQpk0brrzySg+8g9Nzfvr5nJ9+vqfLkFYkwM9CxzbhdGwT7ulSRERERLyKYZre99+nBw4cSN++fXnttdcc27p168bYsWOZMmVKvf0ffvhhvvzyS7Zs2eLYNmnSJNatW8eSJUsadc6ioiKioqIoLCwkMjLy9N+EiIiIiIh4paZkA0sz1eQyVVVVrFq1ilGjRjltHzVqFIsXL27wmCVLltTb/8ILL2TlypVUV1c3eExlZSVFRUVOXyIiIiIiIk3hdYErNzeX2tpaEhMTnbYnJiaSnZ3d4DHZ2dkN7l9TU0Nubm6Dx0yZMoWoqCjHV1pammvegIiIiIiItBpeF7jsjl0PyDTNE64R1ND+DW23e/TRRyksLHR87d279zQrFhERERGR1sbrmmbEx8fj5+dXbzQrJyen3iiWXVJSUoP7+/v7ExfXcFv1oKAggoKCXFO0iIiIiIi0Sl43whUYGEi/fv2YO3eu0/a5c+cyePDgBo8ZNGhQvf3nzJlD//79CQgIcFutIiIiIiLSunld4AKYPHky//nPf5gxYwZbtmzhvvvuIzMz07Gu1qOPPsr48eMd+0+aNIk9e/YwefJktmzZwowZM3jzzTd54IEHPPUWRERERESkFfC6KYUA11xzDXl5eTz99NNkZWXRs2dPZs+eTXp6OgBZWVlkZmY69s/IyGD27Nncd999vPrqq6SkpPDPf/7TK9fgEhERERER7+GV63B5gtbhEhERERER8PF1uERERERERLyFApeIiIiIiIibKHCJiIiIiIi4iQKXiIiIiIiImyhwiYiIiIiIuIkCl4iIiIiIiJsocImIiIiIiLiJApeIiIiIiIibKHCJiIiIiIi4ib+nC/AWpmkCtlWlRURERESk9bJnAntGOBEFrkYqLi4GIC0tzcOViIiIiIhIS1BcXExUVNQJ9zHMxsQywWq1cuDAASIiIjAMw9PlUFRURFpaGnv37iUyMtLT5fgcXV/30vV1L11f99L1dS9dX/fS9XUvXV/3aynX2DRNiouLSUlJwWI58V1aGuFqJIvFQmpqqqfLqCcyMlL/h3YjXV/30vV1L11f99L1dS9dX/fS9XUvXV/3awnX+GQjW3ZqmiEiIiIiIuImClwiIiIiIiJuosDlpYKCgnjiiScICgrydCk+SdfXvXR93UvX1710fd1L19e9dH3dS9fX/bzxGqtphoiIiIiIiJtohEtERERERMRNFLhERERERETcRIFLRERERETETRS4RERERERE3ESBywtNnz6djIwMgoOD6devHz/99JOnS2rxpkyZwtlnn01ERAQJCQmMHTuWX375xWmfiRMnYhiG09c555zjtE9lZSV//OMfiY+PJywsjMsuu4x9+/Y151tpsZ588sl61y8pKcnxvGmaPPnkk6SkpBASEsLw4cPZtGmT02vo+h5f+/bt611fwzC48847AX1+m2rhwoVceumlpKSkYBgGX3zxhdPzrvq8FhQUcMMNNxAVFUVUVBQ33HADhw8fdvO787wTXd/q6moefvhhevXqRVhYGCkpKYwfP54DBw44vcbw4cPrfaZ/97vfOe2j69vw59dV/x7o+jZ8fRv6t9gwDF588UXHPvr8Hl9j/ibztX+DFbi8zKxZs7j33nt57LHHWLNmDUOHDmX06NFkZmZ6urQWbcGCBdx5550sXbqUuXPnUlNTw6hRoygtLXXa76KLLiIrK8vxNXv2bKfn7733Xj7//HM+/PBDFi1aRElJCZdccgm1tbXN+XZarB49ejhdvw0bNjiee+GFF3jppZd45ZVXWLFiBUlJSYwcOZLi4mLHPrq+x7dixQqnazt37lwArr76asc++vw2XmlpKX369OGVV15p8HlXfV6vu+461q5dy7fffsu3337L2rVrueGGG9z+/jztRNe3rKyM1atX8/jjj7N69Wo+++wztm3bxmWXXVZv31tvvdXpM/3GG284Pa/r2/DnF1zz74Gub8PX9+jrmpWVxYwZMzAMgyuvvNJpP31+G9aYv8l87t9gU7zKgAEDzEmTJjlt69q1q/nII494qCLvlJOTYwLmggULHNsmTJhgXn755cc95vDhw2ZAQID54YcfOrbt37/ftFgs5rfffuvOcr3CE088Yfbp06fB56xWq5mUlGQ+99xzjm0VFRVmVFSU+frrr5umqevbVPfcc4/ZsWNH02q1mqapz+/pAMzPP//c8bOrPq+bN282AXPp0qWOfZYsWWIC5tatW938rlqOY69vQ5YvX24C5p49exzbhg0bZt5zzz3HPUbX16ah6+uKfw90fW0a8/m9/PLLzfPOO89pmz6/jXfs32S++G+wRri8SFVVFatWrWLUqFFO20eNGsXixYs9VJV3KiwsBCA2NtZp+/z580lISKBz587ceuut5OTkOJ5btWoV1dXVTtc/JSWFnj176vrX2b59OykpKWRkZPC73/2OnTt3ArBr1y6ys7Odrl1QUBDDhg1zXDtd38arqqrivffe46abbsIwDMd2fX5dw1Wf1yVLlhAVFcXAgQMd+5xzzjlERUXpmh+jsLAQwzCIjo522v7+++8THx9Pjx49eOCBB5z+67au74md7r8Hur6Nc/DgQb755htuvvnmes/p89s4x/5N5ov/Bvs369nktOTm5lJbW0tiYqLT9sTERLKzsz1UlfcxTZPJkydz7rnn0rNnT8f20aNHc/XVV5Oens6uXbt4/PHHOe+881i1ahVBQUFkZ2cTGBhITEyM0+vp+tsMHDiQd955h86dO3Pw4EGeffZZBg8ezKZNmxzXp6HP7p49ewB0fZvgiy++4PDhw0ycONGxTZ9f13HV5zU7O5uEhIR6r5+QkKBrfpSKigoeeeQRrrvuOiIjIx3br7/+ejIyMkhKSmLjxo08+uijrFu3zjGdVtf3+Fzx74Gub+O8/fbbRERE8Nvf/tZpuz6/jdPQ32S++G+wApcXOvq/aIPtw3rsNjm+u+66i/Xr17No0SKn7ddcc43jcc+ePenfvz/p6el888039f4hPZquv83o0aMdj3v16sWgQYPo2LEjb7/9tuNm7VP57Or61vfmm28yevRoUlJSHNv0+XU9V3xeG9pf1/yI6upqfve732G1Wpk+fbrTc7feeqvjcc+ePTnjjDPo378/q1evpm/fvoCu7/G46t8DXd+TmzFj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OmDBggUoKyszaH/nzh3MnDkTbdu2hY2NDezs7PDee+9h5MiROH78eJVjERHVBCZcRES1nKurK0aPHo0HDx5g4cKFJh/v2LFj6NGjB65fv46goCA0atQIv/32GwIDA3Hv3j307t0biYmJaN++Pbp164bs7GxERERg165dRo939+5d+Pr6YufOnQgICEDPnj2RlZWF6Ohoo1/0z58/j06dOmHhwoWoqKjAgAED0KFDB+zduxe9e/fG2rVrjY5TWFgIHx8fpKSkoFu3bggJCanWbXWpqanw9vbG2rVr4eLigvDwcDRt2hQ///wzvL29ceDAAaWtn58foqOjUb9+fQBAdHS08sfGxuaFY23YsEEZy9nZGYMGDYKTkxNWr14Nb29vnD171mi/w4cPw9/fHzdu3EBISAjUajX27NmDXr164Y8//njhuADw7bffon///ti3bx/ef/99hIeHo23btsjNzUVcXJxe24qKCgwePBixsbG4fPkygoKCEBQUhPPnz2P8+PEYNmwYtFqtXp8rV66ga9euWL9+PRo3boyBAwdCq9Vi4MCB+PXXX43GpNVqERkZiZiYGJw+fRre3t4IDg5GYWEhpk6dirCwML1xSkpK4Ovri7lz56KsrAzBwcEICgqCnZ0d1q1bh+3bt1drLYiI3iohIqJaCYBYWlqKiMhff/0lVlZWYmtrK7dv31bazJo1SwDI3Llz9fr26tVLAEhOTo7BcXNycgSA9OrVS69cdywAsmjRIqX86dOnEhQUJACkTZs2EhAQIHfv3lXqv//+ewEg/v7+esdLS0tTjte3b18pKSlR6o4fPy42NjZiZmYmmZmZSnl5ebm0a9dOAMiSJUtEq9UqdSdPnpRGjRpJ/fr15datW0bHGTJkiDx69KjyRX1OSUmJODo6CgBZsWKFXl18fLwAEDc3N3n8+LFenYeHh7zsX6FXr16VevXqiZ2dnezbt0+vbs2aNQJAfHx89MqfPSczZ87UW4/ly5cLAHFxcdGbc2Xn18PDQxo0aGBwTWi1Wtm7d69e2YIFCwSAtG/fXm+tb968KWq1WgBIQkKCXp9+/foJABk/frxUVFQo5d99950yh+joaL0+8+fPV66PgoICpbykpEQGDhwoAGTZsmVKeWJiogCQCRMmyPNu3bolWVlZBuVERDWNCRcRUS31bMIlIhIbGysAZMaMGUqZKRKu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",
      "text/plain": [
       "<Figure size 1000x600 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "_epsilon_scheduler_kwargs = {\n",
    "    \"sched_time_span\": 2000,\n",
    "    \"final_val\": 1e-2,\n",
    "    \"decay_factor\": 0.99\n",
    "}\n",
    "epsilon_scheduler = ExponentialDecay(**_epsilon_scheduler_kwargs)\n",
    "\n",
    "_alpha_scheduler_kwargs = {\n",
    "    \"sched_time_span\": 2000,\n",
    "    \"initial_val\": 0.2,\n",
    "    \"final_val\": 1.,\n",
    "    \"rate\": 0.006\n",
    "}\n",
    "alpha_scheduler = ExponentialAnnealingScheduler(**_alpha_scheduler_kwargs)\n",
    "\n",
    "_beta_scheduler_kwargs = {\n",
    "    \"sched_time_span\": 2000,\n",
    "    \"initial_val\": 0.,\n",
    "    \"final_val\": 1.,\n",
    "    \"rate\": 0.01\n",
    "}\n",
    "beta_scheduler = ExponentialAnnealingScheduler(**_beta_scheduler_kwargs)\n",
    "\n",
    "fig,ax = plt.subplots(1, 1, figsize=(10,6))\n",
    "ax.set_ylabel(\"Epsilon\", rotation=\"vertical\", fontsize=20)\n",
    "ax.set_xlabel(\"Number of episodes\", fontsize=15)\n",
    "ax.set_title(\"Epsilon decay over thet episodes\")\n",
    "\n",
    "ep = np.arange(2000)\n",
    "eps_vals = [epsilon_scheduler(e) for e in ep]\n",
    "alpha_vals = [alpha_scheduler(e) for e in ep]\n",
    "beta_vals = [beta_scheduler(e) for e in ep]\n",
    "ax.plot(ep, eps_vals, label=\"epsilon\")\n",
    "ax.plot(ep, alpha_vals, label=\"alpha\")\n",
    "ax.plot(ep, beta_vals, label=\"beta\")\n",
    "leg = plt.legend(loc='best')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 3. Train the Agent with DQN\n",
    "\n",
    "Run the code cell below to train the agent from scratch.  You are welcome to amend the supplied values of the parameters in the function, to try to see if you can get better performance!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Episode 100\tAverage Score: -163.75\tLatest score: 12.40798\n",
      "Episode 200\tAverage Score: -14.19\tLatest score: -29.358941\n",
      "Episode 300\tAverage Score: 54.92\tLatest score: 121.677903\n",
      "Episode 400\tAverage Score: 80.76\tLatest score: 104.4163\n",
      "Episode 500\tAverage Score: 82.12\tLatest score: 140.27716\n",
      "Episode 600\tAverage Score: 87.33\tLatest score: 104.53895\n",
      "Episode 700\tAverage Score: 82.23\tLatest score: -156.84357\n",
      "Episode 800\tAverage Score: 126.50\tLatest score: 120.52800\n",
      "Episode 900\tAverage Score: 154.09\tLatest score: 285.07180\n",
      "Episode 1000\tAverage Score: 160.84\tLatest score: 200.6292\n",
      "Episode 1100\tAverage Score: 201.77\tLatest score: 191.33649\n",
      "Episode 1200\tAverage Score: 205.04\tLatest score: 283.8917\n",
      "Episode 1300\tAverage Score: 197.87\tLatest score: 276.04904\n",
      "Episode 1400\tAverage Score: 201.02\tLatest score: 260.40455\n",
      "Episode 1500\tAverage Score: 198.20\tLatest score: -19.95245\n",
      "Episode 1600\tAverage Score: 212.29\tLatest score: 269.0771\n",
      "Episode 1675\tAverage Score: 169.56\tLatest score: 188.56450"
     ]
    },
    {
     "ename": "KeyboardInterrupt",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
      "Cell \u001b[0;32mIn[5], line 56\u001b[0m\n\u001b[1;32m     47\u001b[0m agent \u001b[38;5;241m=\u001b[39m DoubleDQN_Agent(state_size\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m8\u001b[39m, action_size\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m4\u001b[39m, seed\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m761\u001b[39m)\n\u001b[1;32m     48\u001b[0m _double_dqn_kwargs \u001b[38;5;241m=\u001b[39m {\n\u001b[1;32m     49\u001b[0m     \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mdqn_agent\u001b[39m\u001b[38;5;124m\"\u001b[39m: agent,\n\u001b[1;32m     50\u001b[0m     \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mn_episodes\u001b[39m\u001b[38;5;124m\"\u001b[39m: \u001b[38;5;241m5000\u001b[39m,\n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m     54\u001b[0m     \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mtarget_mean_score\u001b[39m\u001b[38;5;124m\"\u001b[39m:\u001b[38;5;241m245.\u001b[39m\n\u001b[1;32m     55\u001b[0m }\n\u001b[0;32m---> 56\u001b[0m double_dqn_scores \u001b[38;5;241m=\u001b[39m \u001b[43mdouble_dqn\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43m_double_dqn_kwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     58\u001b[0m \u001b[38;5;66;03m# plot the scores\u001b[39;00m\n\u001b[1;32m     59\u001b[0m fig, axes \u001b[38;5;241m=\u001b[39m plt\u001b[38;5;241m.\u001b[39msubplots(\u001b[38;5;241m1\u001b[39m, \u001b[38;5;241m1\u001b[39m, figsize\u001b[38;5;241m=\u001b[39m(\u001b[38;5;241m10\u001b[39m, \u001b[38;5;241m6\u001b[39m), sharex\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m, sharey\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n",
      "Cell \u001b[0;32mIn[5], line 30\u001b[0m, in \u001b[0;36mdouble_dqn\u001b[0;34m(dqn_agent, n_episodes, max_t, eps_decay_fn, UPDATE_EVERY, target_mean_score)\u001b[0m\n\u001b[1;32m     28\u001b[0m     action \u001b[38;5;241m=\u001b[39m dqn_agent\u001b[38;5;241m.\u001b[39mact(state, eps)\n\u001b[1;32m     29\u001b[0m next_state, reward, done, truncated, _ \u001b[38;5;241m=\u001b[39m env\u001b[38;5;241m.\u001b[39mstep(action)\n\u001b[0;32m---> 30\u001b[0m \u001b[43mdqn_agent\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mstep\u001b[49m\u001b[43m(\u001b[49m\u001b[43mstate\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43maction\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mreward\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mnext_state\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mdone\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mt_step\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     31\u001b[0m state \u001b[38;5;241m=\u001b[39m next_state\n\u001b[1;32m     32\u001b[0m score \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m reward\n",
      "File \u001b[0;32m/workspaces/deep-reinforcement-learning/dqn/exercise/dqn_agent.py:92\u001b[0m, in \u001b[0;36mDoubleDQN_Agent.step\u001b[0;34m(self, state, action, reward, next_state, done, t_step)\u001b[0m\n\u001b[1;32m     90\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_underline_step(state, action, reward, next_state, done, t_step):\n\u001b[1;32m     91\u001b[0m     experiences \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mmemory\u001b[38;5;241m.\u001b[39msample(BATCH_SIZE)\n\u001b[0;32m---> 92\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mlearn\u001b[49m\u001b[43m(\u001b[49m\u001b[43mexperiences\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mGAMMA\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[0;32m/workspaces/deep-reinforcement-learning/dqn/exercise/dqn_agent.py:129\u001b[0m, in \u001b[0;36mDoubleDQN_Agent.learn\u001b[0;34m(self, experiences, gamma)\u001b[0m\n\u001b[1;32m    127\u001b[0m Q_next \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_target_model(next_states)\u001b[38;5;241m.\u001b[39mdetach()\u001b[38;5;241m.\u001b[39mmax(\u001b[38;5;241m1\u001b[39m)[\u001b[38;5;241m0\u001b[39m]\u001b[38;5;241m.\u001b[39munsqueeze(\u001b[38;5;241m1\u001b[39m)\n\u001b[1;32m    128\u001b[0m Q_target \u001b[38;5;241m=\u001b[39m rewards \u001b[38;5;241m+\u001b[39m (gamma \u001b[38;5;241m*\u001b[39m Q_next \u001b[38;5;241m*\u001b[39m (\u001b[38;5;241m1\u001b[39m \u001b[38;5;241m-\u001b[39m dones))\n\u001b[0;32m--> 129\u001b[0m Q \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_training_model\u001b[49m\u001b[43m(\u001b[49m\u001b[43mstates\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241m.\u001b[39mgather(\u001b[38;5;241m1\u001b[39m, actions)\n\u001b[1;32m    130\u001b[0m loss \u001b[38;5;241m=\u001b[39m F\u001b[38;5;241m.\u001b[39mmse_loss(Q_target, Q)\n\u001b[1;32m    131\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39moptimizer\u001b[38;5;241m.\u001b[39mzero_grad()\n",
      "File \u001b[0;32m~/.conda/envs/deepReinforcement/lib/python3.10/site-packages/torch/nn/modules/module.py:1518\u001b[0m, in \u001b[0;36mModule._wrapped_call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1516\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_compiled_call_impl(\u001b[38;5;241m*\u001b[39margs, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs)  \u001b[38;5;66;03m# type: ignore[misc]\u001b[39;00m\n\u001b[1;32m   1517\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m-> 1518\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_call_impl\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[0;32m~/.conda/envs/deepReinforcement/lib/python3.10/site-packages/torch/nn/modules/module.py:1527\u001b[0m, in \u001b[0;36mModule._call_impl\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1522\u001b[0m \u001b[38;5;66;03m# If we don't have any hooks, we want to skip the rest of the logic in\u001b[39;00m\n\u001b[1;32m   1523\u001b[0m \u001b[38;5;66;03m# this function, and just call forward.\u001b[39;00m\n\u001b[1;32m   1524\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m (\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_backward_hooks \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_backward_pre_hooks \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_forward_hooks \u001b[38;5;129;01mor\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_forward_pre_hooks\n\u001b[1;32m   1525\u001b[0m         \u001b[38;5;129;01mor\u001b[39;00m _global_backward_pre_hooks \u001b[38;5;129;01mor\u001b[39;00m _global_backward_hooks\n\u001b[1;32m   1526\u001b[0m         \u001b[38;5;129;01mor\u001b[39;00m _global_forward_hooks \u001b[38;5;129;01mor\u001b[39;00m _global_forward_pre_hooks):\n\u001b[0;32m-> 1527\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mforward_call\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m   1529\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m   1530\u001b[0m     result \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mNone\u001b[39;00m\n",
      "File \u001b[0;32m/workspaces/deep-reinforcement-learning/dqn/exercise/model.py:50\u001b[0m, in \u001b[0;36mQNetwork.forward\u001b[0;34m(self, state)\u001b[0m\n\u001b[1;32m     45\u001b[0m \u001b[38;5;250m\u001b[39m\u001b[38;5;124;03m\"\"\"Build a network that maps state -> action values.\"\"\"\u001b[39;00m\n\u001b[1;32m     46\u001b[0m \u001b[38;5;66;03m#o = self.relu(self.conv_hidden1(state))\u001b[39;00m\n\u001b[1;32m     47\u001b[0m \u001b[38;5;66;03m#o = self.relu(self.conv_hidden2(o))\u001b[39;00m\n\u001b[1;32m     48\u001b[0m \u001b[38;5;66;03m#o = self.relu(self.conv_hidden3(o))\u001b[39;00m\n\u001b[1;32m     49\u001b[0m \u001b[38;5;66;03m#o = self.relu(self.fc1(o.view(-1, 64*7*7)))\u001b[39;00m\n\u001b[0;32m---> 50\u001b[0m o_main \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mrelu\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mfc_main\u001b[49m\u001b[43m(\u001b[49m\u001b[43mstate\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     51\u001b[0m o_lateral \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mrelu(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfc_lateral(state))\n\u001b[1;32m     52\u001b[0m o_physics \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mrelu(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mfc_physics(state))\n",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
     ]
    }
   ],
   "source": [
    "def double_dqn(\n",
    "        dqn_agent,\n",
    "        n_episodes,\n",
    "        max_t,\n",
    "        eps_decay_fn: typing.Callable[[float], float],\n",
    "        UPDATE_EVERY:int = 4,\n",
    "        target_mean_score=200.0):\n",
    "    \"\"\"Deep Q-Learning.\n",
    "    \n",
    "    Params\n",
    "    ======\n",
    "        n_episodes (int): maximum number of training episodes\n",
    "        max_t (int): maximum number of timesteps per episode\n",
    "        eps_start (float): starting value of epsilon, for epsilon-greedy action selection\n",
    "        eps_end (float): minimum value of epsilon\n",
    "        eps_decay (float): multiplicative factor (per episode) for decreasing epsilon\n",
    "    \"\"\"\n",
    "    scores = []                        # list containing scores from each episode\n",
    "    scores_window = deque(maxlen=100)  # last 100 scores\n",
    "    t_step = -1\n",
    "    for i_episode in range(1, n_episodes+1):\n",
    "        state = env.reset()[0]\n",
    "        score = 0\n",
    "        eps = eps_decay_fn(i_episode)\n",
    "        for t in range(max_t):\n",
    "            t_step = (t_step + 1) % UPDATE_EVERY\n",
    "            if t_step == 0:\n",
    "                action = dqn_agent.act(state, eps)\n",
    "            next_state, reward, done, truncated, _ = env.step(action)\n",
    "            dqn_agent.step(state, action, reward, next_state, done, t_step)\n",
    "            state = next_state\n",
    "            score += reward\n",
    "            if done:  # or truncated:\n",
    "                break\n",
    "        scores_window.append(score)       # save most recent score\n",
    "        scores.append(score)              # save most recent score\n",
    "        print('\\rEpisode {}\\tAverage Score: {:.2f}\\tLatest score: {:.4f}'.format(i_episode, np.mean(scores_window), score), end='')\n",
    "        if i_episode % 100 == 0:\n",
    "            print('\\rEpisode {}\\tAverage Score: {:.2f}\\tLatest score: {:.4f}'.format(i_episode, np.mean(scores_window), score))\n",
    "        scores_windows_list = list(scores_window)\n",
    "        if np.mean(scores_window) >= target_mean_score and np.mean(scores_windows_list[-10:]) >= target_mean_score:\n",
    "            print('\\nEnvironment solved in {:d} episodes!\\tAverage Score: {:.2f}'.format(i_episode-100, np.mean(scores_window)))\n",
    "            torch.save(dqn_agent.qnetwork_model.state_dict(), 'double_dqn_checkpoint.pth')\n",
    "            break\n",
    "    return pd.Series(scores, name=\"scores\")\n",
    "\n",
    "agent = DoubleDQN_Agent(state_size=8, action_size=4, seed=761)\n",
    "_double_dqn_kwargs = {\n",
    "    \"dqn_agent\": agent,\n",
    "    \"n_episodes\": 5000,\n",
    "    \"max_t\": 250,\n",
    "    \"eps_decay_fn\": epsilon_scheduler,\n",
    "    \"UPDATE_EVERY\": 4,\n",
    "    \"target_mean_score\":245.\n",
    "}\n",
    "double_dqn_scores = double_dqn(**_double_dqn_kwargs)\n",
    "\n",
    "# plot the scores\n",
    "fig, axes = plt.subplots(1, 1, figsize=(10, 6), sharex=True, sharey=True)\n",
    "double_dqn_scores.plot(ax=axes, label=\"DQN Scores\")\n",
    "(double_dqn_scores.rolling(window=100)\n",
    "           .mean()\n",
    "           .rename(\"Rolling Average\")\n",
    "           .plot(ax=axes))\n",
    "axes.legend()\n",
    "_ = axes.set_ylabel(\"Score\")\n",
    "del agent"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 4. Watch a Smart Agent!\n",
    "\n",
    "In the next code cell, you will load the trained weights from file to watch a smart agent!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "frame_counters = []\n",
    "rewards = []\n",
    "# load the weights from file\n",
    "trained_agent = DoubleDQN_Agent(state_size=8, action_size=4, seed=761)\n",
    "trained_agent.qnetwork_model.load_state_dict(torch.load('double_dqn_checkpoint.pth'))\n",
    "for i in range(5):\n",
    "    total_rewards = 0\n",
    "    frame_counter = 0\n",
    "    state = env.reset()[0]\n",
    "    img = plt.imshow(env.render())\n",
    "    for j in range(200):\n",
    "        action = trained_agent.act(state)\n",
    "        img.set_data(env.render()) \n",
    "        plt.axis('off')\n",
    "        display.display(plt.gcf())\n",
    "        display.clear_output(wait=True)\n",
    "        state, reward, done, _, __ = env.step(action)\n",
    "        frame_counter += 1\n",
    "        total_rewards += reward\n",
    "        if done:\n",
    "            break\n",
    "    frame_counters.append(frame_counter)\n",
    "    rewards.append(total_rewards)\n",
    "del trained_agent"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "rewards: [306.0397824675781, 283.8078575758004, 273.59011327710687, 271.5033461525877, 286.7743971315776]\n",
      "frame counters: [150, 190, 184, 180, 190]\n"
     ]
    }
   ],
   "source": [
    "print(f'rewards: {rewards}')\n",
    "print(f'frame counters: {frame_counters}')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### C) Double DQN with Prioritized Replay Buffer\n",
    "#### Train the Agent with DQN\n",
    "\n",
    "Run the code cell below to train the agent from scratch.  You are welcome to amend the supplied values of the parameters in the function, to try to see if you can get better performance!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Episode 100\tAverage Score: -196.18\tLatest score: -334.1085\n",
      "Episode 200\tAverage Score: -76.30\tLatest score: 46.1480155\n",
      "Episode 300\tAverage Score: -50.54\tLatest score: -96.56893\n",
      "Episode 400\tAverage Score: -19.52\tLatest score: 6.4992634\n",
      "Episode 500\tAverage Score: 34.01\tLatest score: 81.8986707\n",
      "Episode 600\tAverage Score: -1.81\tLatest score: -31.68861\n",
      "Episode 700\tAverage Score: 0.11\tLatest score: -37.0959800\n",
      "Episode 800\tAverage Score: 20.51\tLatest score: 149.61304\n",
      "Episode 900\tAverage Score: 36.21\tLatest score: 76.683985\n",
      "Episode 1000\tAverage Score: -5.15\tLatest score: -162.5859\n",
      "Episode 1100\tAverage Score: -48.05\tLatest score: -39.06984\n",
      "Episode 1200\tAverage Score: -29.14\tLatest score: 43.355342\n",
      "Episode 1300\tAverage Score: 7.70\tLatest score: 43.91896961\n",
      "Episode 1400\tAverage Score: -50.49\tLatest score: -35.38477\n",
      "Episode 1500\tAverage Score: 21.53\tLatest score: 125.462234\n",
      "Episode 1600\tAverage Score: 48.05\tLatest score: 113.74384\n",
      "Episode 1700\tAverage Score: 0.31\tLatest score: -20.026492\n",
      "Episode 1800\tAverage Score: 48.87\tLatest score: 29.645800\n",
      "Episode 1900\tAverage Score: 73.21\tLatest score: 88.995999\n",
      "Episode 2000\tAverage Score: 65.99\tLatest score: 5.7927712\n",
      "Episode 2100\tAverage Score: 82.79\tLatest score: 70.608250\n",
      "Episode 2200\tAverage Score: 88.03\tLatest score: 50.9792612\n",
      "Episode 2300\tAverage Score: 105.52\tLatest score: 108.27288\n",
      "Episode 2400\tAverage Score: 70.76\tLatest score: 139.24482\n",
      "Episode 2500\tAverage Score: 10.11\tLatest score: 53.644935\n",
      "Episode 2600\tAverage Score: 66.84\tLatest score: -102.7965\n",
      "Episode 2700\tAverage Score: 29.63\tLatest score: 148.56417\n",
      "Episode 2800\tAverage Score: 90.48\tLatest score: 78.613083\n",
      "Episode 2900\tAverage Score: 102.29\tLatest score: 148.48679\n",
      "Episode 3000\tAverage Score: 131.34\tLatest score: 154.01981\n",
      "Episode 3100\tAverage Score: 100.02\tLatest score: 157.06418\n",
      "Episode 3200\tAverage Score: 112.29\tLatest score: 236.38690\n",
      "Episode 3300\tAverage Score: 155.68\tLatest score: 108.9350\n",
      "Episode 3400\tAverage Score: 65.99\tLatest score: 98.5388071\n",
      "Episode 3500\tAverage Score: 152.39\tLatest score: 177.59962\n",
      "Episode 3600\tAverage Score: 129.14\tLatest score: 99.913739\n",
      "Episode 3690\tAverage Score: 126.78\tLatest score: 103.83742"
     ]
    },
    {
     "ename": "KeyboardInterrupt",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
      "Cell \u001b[0;32mIn[4], line 63\u001b[0m\n\u001b[1;32m     60\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m pd\u001b[38;5;241m.\u001b[39mSeries(scores, name\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mscores\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m     62\u001b[0m agent \u001b[38;5;241m=\u001b[39m AgentPrioritizedReplayBuf(state_size\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m8\u001b[39m, action_size\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m4\u001b[39m, seed\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m761\u001b[39m, alpha\u001b[38;5;241m=\u001b[39mINIT_ALPHA_VALUE)\n\u001b[0;32m---> 63\u001b[0m ddqn_prio_replaybuff_scores \u001b[38;5;241m=\u001b[39m \u001b[43mdouble_dqn_prioritizedReplayBuffer\u001b[49m\u001b[43m(\u001b[49m\u001b[43magent\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mn_episodes\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;241;43m5000\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmax_t\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;241;43m250\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[1;32m     64\u001b[0m \u001b[43m                                                                 \u001b[49m\u001b[43malpha_start\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mINIT_ALPHA_VALUE\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43malpha_end\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;241;43m1.\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[1;32m     65\u001b[0m \u001b[43m                                                                 \u001b[49m\u001b[43mbeta_start\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mINIT_BETA_VALUE\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbeta_end\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;241;43m1.\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[1;32m     66\u001b[0m \u001b[43m                                                                 \u001b[49m\u001b[43mUPDATE_EVERY\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;241;43m4\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[1;32m     67\u001b[0m \u001b[43m                                                                 \u001b[49m\u001b[43mtarget_mean_score\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;241;43m245.\u001b[39;49m\u001b[43m)\u001b[49m\n\u001b[1;32m     69\u001b[0m \u001b[38;5;66;03m# plot the scores\u001b[39;00m\n\u001b[1;32m     70\u001b[0m fig, axes \u001b[38;5;241m=\u001b[39m plt\u001b[38;5;241m.\u001b[39msubplots(\u001b[38;5;241m1\u001b[39m, \u001b[38;5;241m1\u001b[39m, figsize\u001b[38;5;241m=\u001b[39m(\u001b[38;5;241m10\u001b[39m, \u001b[38;5;241m6\u001b[39m), sharex\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m, sharey\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n",
      "Cell \u001b[0;32mIn[4], line 43\u001b[0m, in \u001b[0;36mdouble_dqn_prioritizedReplayBuffer\u001b[0;34m(dqn_agent, n_episodes, max_t, eps_start, eps_end, eps_decay, alpha_start, alpha_end, beta_start, beta_end, UPDATE_EVERY, target_mean_score)\u001b[0m\n\u001b[1;32m     41\u001b[0m     action \u001b[38;5;241m=\u001b[39m dqn_agent\u001b[38;5;241m.\u001b[39mact(state, eps)\n\u001b[1;32m     42\u001b[0m next_state, reward, done, truncated, _ \u001b[38;5;241m=\u001b[39m env\u001b[38;5;241m.\u001b[39mstep(action)\n\u001b[0;32m---> 43\u001b[0m \u001b[43mdqn_agent\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mstep\u001b[49m\u001b[43m(\u001b[49m\u001b[43mstate\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mstate\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43maction\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43maction\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mreward\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mreward\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mnext_state\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mnext_state\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mdone\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mdone\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m     44\u001b[0m \u001b[43m               \u001b[49m\u001b[43mt_step\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mt_step\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mnew_alpha\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43malpha_scheduler\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget_step\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mnew_beta\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mbeta_scheduler\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget_step\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     45\u001b[0m state \u001b[38;5;241m=\u001b[39m next_state\n\u001b[1;32m     46\u001b[0m score \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m reward\n",
      "File \u001b[0;32m/workspaces/deep-reinforcement-learning/dqn/exercise/dqn_agent.py:180\u001b[0m, in \u001b[0;36mAgentPrioritizedReplayBuf.step\u001b[0;34m(self, state, action, reward, next_state, done, t_step, new_alpha, new_beta)\u001b[0m\n\u001b[1;32m    177\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_underline_step(state, action, reward, next_state, done, t_step):\n\u001b[1;32m    178\u001b[0m     \u001b[38;5;241m*\u001b[39mexperiences, weights, indices \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mmemory\u001b[38;5;241m.\u001b[39msample(batch_size\u001b[38;5;241m=\u001b[39mBATCH_SIZE,\n\u001b[1;32m    179\u001b[0m                                                         beta\u001b[38;5;241m=\u001b[39mnew_beta)\n\u001b[0;32m--> 180\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mlearn\u001b[49m\u001b[43m(\u001b[49m\u001b[43mexperiences\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mexperiences\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mgamma\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mGAMMA\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mweights\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mweights\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mindices\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mindices\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[0;32m/workspaces/deep-reinforcement-learning/dqn/exercise/dqn_agent.py:205\u001b[0m, in \u001b[0;36mAgentPrioritizedReplayBuf.learn\u001b[0;34m(self, experiences, gamma, weights, indices)\u001b[0m\n\u001b[1;32m    203\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39msoft_update(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_training_model, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_target_model, TAU)\n\u001b[1;32m    204\u001b[0m \u001b[38;5;66;03m# update priorities\u001b[39;00m\n\u001b[0;32m--> 205\u001b[0m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mmemory\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mupdate_priorities\u001b[49m\u001b[43m(\u001b[49m\u001b[43midxs\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mindices\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mpriorities\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mtd_error\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mnumpy\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m+\u001b[39;49m\u001b[43m \u001b[49m\u001b[38;5;241;43m5e-5\u001b[39;49m\u001b[43m)\u001b[49m\n",
      "File \u001b[0;32m/workspaces/deep-reinforcement-learning/dqn/exercise/common/replay_buffer.py:125\u001b[0m, in \u001b[0;36mPrioritizedReplayBuffer.update_priorities\u001b[0;34m(self, idxs, priorities)\u001b[0m\n\u001b[1;32m    123\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m (\u001b[38;5;241m0\u001b[39m \u001b[38;5;241m<\u001b[39m\u001b[38;5;241m=\u001b[39m idx \u001b[38;5;241m<\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m\u001b[38;5;21m__len__\u001b[39m()):\n\u001b[1;32m    124\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mException\u001b[39;00m(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mIndex is out of Buffer capacity\u001b[39m\u001b[38;5;130;01m\\'\u001b[39;00m\u001b[38;5;124ms range\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[0;32m--> 125\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_it_sum[idx] \u001b[38;5;241m=\u001b[39m priority\u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_alpha\n\u001b[1;32m    126\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_it_min[idx] \u001b[38;5;241m=\u001b[39m priority\u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_alpha\n\u001b[1;32m    127\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_max_priority \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mmax\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_max_priority, priority)\n",
      "File \u001b[0;32m/workspaces/deep-reinforcement-learning/dqn/exercise/common/segment_tree.py:98\u001b[0m, in \u001b[0;36mSegmentTree.__setitem__\u001b[0;34m(self, idx, val)\u001b[0m\n\u001b[1;32m     96\u001b[0m idx \u001b[38;5;241m/\u001b[39m\u001b[38;5;241m/\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;241m2\u001b[39m\n\u001b[1;32m     97\u001b[0m \u001b[38;5;28;01mwhile\u001b[39;00m idx \u001b[38;5;241m>\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m---> 98\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_value[idx] \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_operation\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_value\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;241;43m2\u001b[39;49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43m \u001b[49m\u001b[43midx\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_value\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;241;43m2\u001b[39;49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43m \u001b[49m\u001b[43midx\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m+\u001b[39;49m\u001b[43m \u001b[49m\u001b[38;5;241;43m1\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     99\u001b[0m     idx \u001b[38;5;241m/\u001b[39m\u001b[38;5;241m/\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;241m2\u001b[39m\n",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
     ]
    }
   ],
   "source": [
    "INIT_ALPHA_VALUE = 1.\n",
    "INIT_BETA_VALUE = 1.\n",
    "def double_dqn_prioritizedReplayBuffer(\n",
    "        dqn_agent,\n",
    "        n_episodes=2000,\n",
    "        max_t=1000,\n",
    "        eps_start=1.0,\n",
    "        eps_end=0.01,\n",
    "        eps_decay=0.995,\n",
    "        alpha_start=0.,\n",
    "        alpha_end=1.,\n",
    "        beta_start=0.,\n",
    "        beta_end=1.,\n",
    "        UPDATE_EVERY = 4,\n",
    "        target_mean_score=200.0):\n",
    "    \"\"\"Deep Q-Learning.\n",
    "    \n",
    "    Params\n",
    "    ======\n",
    "        n_episodes (int): maximum number of training episodes\n",
    "        max_t (int): maximum number of timesteps per episode\n",
    "        eps_start (float): starting value of epsilon, for epsilon-greedy action selection\n",
    "        eps_end (float): minimum value of epsilon\n",
    "        eps_decay (float): multiplicative factor (per episode) for decreasing epsilon\n",
    "    \"\"\"\n",
    "    scores = []                        # list containing scores from each episode\n",
    "    scores_window = deque(maxlen=100)  # last 100 scores\n",
    "    eps = eps_start                    # initialize epsilon\n",
    "    t_step = -1\n",
    "    alpha_scheduler = LinearScheduler(sched_time_span=n_episodes-0.05*n_episodes, initial_val=alpha_start,\n",
    "                                      final_val=alpha_end)\n",
    "    beta_scheduler = LinearScheduler(sched_time_span=n_episodes-0.05*n_episodes, initial_val=beta_start,\n",
    "                                     final_val=beta_end)\n",
    "    for i_episode in range(1, n_episodes+1):\n",
    "        state = env.reset()[0]\n",
    "        score = 0\n",
    "        \n",
    "        for t in range(max_t):\n",
    "            t_step = (t_step + 1) % UPDATE_EVERY\n",
    "            if t_step == 0:\n",
    "                action = dqn_agent.act(state, eps)\n",
    "            next_state, reward, done, truncated, _ = env.step(action)\n",
    "            dqn_agent.step(state=state, action=action, reward=reward, next_state=next_state, done=done,\n",
    "                           t_step=t_step, new_alpha=alpha_scheduler.get_step(), new_beta=beta_scheduler.get_step())\n",
    "            state = next_state\n",
    "            score += reward\n",
    "            if done:  # or truncated:\n",
    "                break\n",
    "        scores_window.append(score)       # save most recent score\n",
    "        scores.append(score)              # save most recent score\n",
    "        eps = max(eps_end, eps_decay*eps) # decrease epsilon\n",
    "        print('\\rEpisode {}\\tAverage Score: {:.2f}\\tLatest score: {:.4f}'.format(i_episode, np.mean(scores_window), score), end='')\n",
    "        if i_episode % 100 == 0:\n",
    "            print('\\rEpisode {}\\tAverage Score: {:.2f}\\tLatest score: {:.4f}'.format(i_episode, np.mean(scores_window), score))\n",
    "        scores_windows_list = list(scores_window)\n",
    "        if np.mean(scores_window) >= target_mean_score and np.mean(scores_windows_list[-10:]) >= target_mean_score:\n",
    "            print('\\nEnvironment solved in {:d} episodes!\\tAverage Score: {:.2f}'.format(i_episode-100, np.mean(scores_window)))\n",
    "            torch.save(dqn_agent.qnetwork_model.state_dict(), 'ddqn_prio_replaybuff_checkpoint.pth')\n",
    "            break\n",
    "    return pd.Series(scores, name=\"scores\")\n",
    "\n",
    "agent = AgentPrioritizedReplayBuf(state_size=8, action_size=4, seed=761, alpha=INIT_ALPHA_VALUE)\n",
    "ddqn_prio_replaybuff_scores = double_dqn_prioritizedReplayBuffer(agent, n_episodes=5000, max_t=250,\n",
    "                                                                 alpha_start=INIT_ALPHA_VALUE, alpha_end=1.,\n",
    "                                                                 beta_start=INIT_BETA_VALUE, beta_end=1.,\n",
    "                                                                 UPDATE_EVERY=4,\n",
    "                                                                 target_mean_score=245.)\n",
    "\n",
    "# plot the scores\n",
    "fig, axes = plt.subplots(1, 1, figsize=(10, 6), sharex=True, sharey=True)\n",
    "ddqn_prio_replaybuff_scores.plot(ax=axes, label=\"DQN Scores\")\n",
    "(ddqn_prio_replaybuff_scores.rolling(window=100)\n",
    "           .mean()\n",
    "           .rename(\"Rolling Average\")\n",
    "           .plot(ax=axes))\n",
    "axes.legend()\n",
    "_ = axes.set_ylabel(\"Score\")\n",
    "del agent"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Watch a Smart Agent!\n",
    "\n",
    "In the next code cell, you will load the trained weights from file to watch a smart agent!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "frame_counters = []\n",
    "rewards = []\n",
    "# load the weights from file\n",
    "trained_agent = AgentPrioritizedReplayBuf(state_size=8, action_size=4, seed=761)\n",
    "trained_agent.qnetwork_model.load_state_dict(torch.load('ddqn_prio_replaybuff_checkpoint.pth'))\n",
    "for i in range(5):\n",
    "    total_rewards = 0\n",
    "    frame_counter = 0\n",
    "    state = env.reset()[0]\n",
    "    img = plt.imshow(env.render())\n",
    "    for j in range(200):\n",
    "        action = trained_agent.act(state)\n",
    "        img.set_data(env.render()) \n",
    "        plt.axis('off')\n",
    "        display.display(plt.gcf())\n",
    "        display.clear_output(wait=True)\n",
    "        state, reward, done, _, __ = env.step(action)\n",
    "        frame_counter += 1\n",
    "        total_rewards += reward\n",
    "        if done:\n",
    "            break\n",
    "    frame_counters.append(frame_counter)\n",
    "    rewards.append(total_rewards)\n",
    "del trained_agent"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "print(f'rewards: {rewards}')\n",
    "print(f'frame counters: {frame_counters}')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 5. Explore\n",
    "\n",
    "In this exercise, you have implemented a DQN agent and demonstrated how to use it to solve an OpenAI Gym environment.  To continue your learning, you are encouraged to complete any (or all!) of the following tasks:\n",
    "- Amend the various hyperparameters and network architecture to see if you can get your agent to solve the environment faster.  Once you build intuition for the hyperparameters that work well with this environment, try solving a different OpenAI Gym task with discrete actions!\n",
    "- You may like to implement some improvements such as prioritized experience replay, Double DQN, or Dueling DQN! \n",
    "- Write a blog post explaining the intuition behind the DQN algorithm and demonstrating how to use it to solve an RL environment of your choosing.  "
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
